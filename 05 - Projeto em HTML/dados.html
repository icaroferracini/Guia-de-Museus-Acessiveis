<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análise de Dados - GUIA DE MUSEUS ACESSÍVEIS DO BRASIL - GuiMA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1351b4;
            --bg-secondary: #ebebeb;
            --text-primary: #ffffff;
            --text-secondary: #111;
            --link: #1351b4;
            --button-bg: #1351b4;
            --button-text: #ffffff;
            --content-bg: #ffffff;
            --focus-outline: #ffcd07;
            --bg-square: #DDD;
            --bar-color: #1351b4;
            --bar-bg: #ececec;
        }

        body.dark-mode {
            --bg-primary: #071d41;
            --bg-secondary: #2d2d2d;
            --text-primary: #f8f9fa;
            --text-secondary: #e0e0e0;
            --link: #6bb3ff;
            --button-bg: #2968d8;
            --button-text: #ffffff;
            --content-bg: #0f0f0f;
            --focus-outline: #ffcd07;
            --bg-square: #333;
            --bar-color: #6bb3ff;
            --bar-bg: #333;
        }

        html {
            font-size: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--content-bg);
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .skip-link {
            color: var(--text-primary);
            z-index: -10000;
            border: none;
            font-size: 0.875rem;
            cursor: pointer;
            text-decoration: underline;
            padding: 0.25rem 0.5rem;
        }

        .skip-link:focus {
            z-index: 10000;
            outline: 2px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 4px;
        }

        .top-header {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            padding: 0.75rem 2.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .site-title {
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: 0.03125rem;
        }

        .accessibility-controls {
            display: flex;
            gap: 1.25rem;
            align-items: center;
        }

        .accessibility-controls button,
        .accessibility-controls a {
            background: transparent;
            color: var(--text-primary);
            border: none;
            font-size: 0.875rem;
            cursor: pointer;
            text-decoration: none;
            padding: 0.25rem 0.5rem;
            font-weight: 500;
        }

        .accessibility-controls button:hover,
        .accessibility-controls a:hover {
            opacity: 0.85;
        }

        .accessibility-controls button:focus,
        .accessibility-controls a:focus {
            outline: 2px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 4px;
            opacity: 1;
        }

        .main-header {
            background-color: var(--content-bg);
            padding: 1.5rem 2.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .logo {
            font-size: 4rem;
            font-weight: 700;
            color: var(--link);
            text-decoration: none;
            letter-spacing: -0.0625rem;
        }

        .logo:hover {
            opacity: 0.85;
        }

        .logo:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 0.25rem;
            border-radius: 0.5rem;
        }

        .main-nav {
            display: flex;
            gap: 0.75rem;
        }

        .nav-button {
            background-color: transparent;
            color: var(--link);
            border: 2px solid var(--button-bg);
            padding: 0.75rem 1.75rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 6.25rem;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }

        body.dark-mode .nav-button {
            color: var(--text-primary);
            border-color: var(--button-bg);
        }

        .nav-button:hover {
            background-color: var(--button-bg);
            color: var(--button-text);
            box-shadow: 0 0.25rem 0.5rem rgba(19, 81, 180, 0.2);
        }

        .nav-button:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }

        .nav-button.active {
            background-color: var(--button-bg);
            color: var(--button-text);
        }

        strong {
            font-weight: 600;
        }

        .content-area {
            background-color: var(--bg-secondary);
            min-height: 31.25rem;
            padding: 2.5rem;
        }

        .back-to-top {
            position: absolute;
            left: -9999px;
            color: var(--button-text);
            background: var(--button-bg);
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            text-decoration: none;
            border-radius: 0.25rem;
            z-index: 10000;
        }

        .back-to-top:focus {
            position: fixed;
            bottom: 2.5rem;
            left: 2rem;
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            color: var(--button-text);
            background: var(--button-bg);
        }

        .footer {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            padding: 1rem 2.5rem;
            text-align: center;
        }

        .footer-text {
            font-size: 0.875rem;
            font-weight: 400;
            letter-spacing: 0.03125rem;
            line-height: 1.6;
            max-width: 56.25rem;
            margin: 0 auto;
        }

        .article-section {
            margin: 0 auto 3rem;
            background: var(--content-bg);
            padding: 2.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .article-section h2 {
            color: var(--link);
            font-size: 1.75rem;
            margin-bottom: 1rem;
            font-weight: 700;
            text-align: center;
        }

        .article-section h3 {
            color: var(--link);
            font-size: 1.25rem;
            margin: 1.5rem 0 1rem;
            font-weight: 600;
        }

        .article-section p {
            margin-bottom: 1rem;
        }

        .card-title {
            color: var(--link);
            font-size: 1.75rem;
            margin-bottom: 1rem;
            font-weight: 700;
            text-align: center;
        }

        .filter-section {
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
        }

        .filter-description {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            margin-bottom: 1.25rem;
            text-align: center;
            line-height: 1.6;
        }

        .radio-group {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .radio-option {
            position: relative;
        }

        .radio-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            margin: 0;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.4rem 0.65rem;
            border: 2px solid var(--bg-secondary);
            border-radius: 0.5rem;
            background-color: var(--content-bg);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            min-height: 3rem;
        }

        .radio-option input[type="radio"]:checked+.radio-label {
            border-color: var(--button-bg);
            background-color: var(--content-bg);
        }

        .radio-option input[type="radio"]:hover+.radio-label {
            border-color: var(--button-bg);
            opacity: 0.8;
        }

        .radio-option input[type="radio"]:focus+.radio-label {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }

        .radio-indicator {
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid var(--text-secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s ease;
        }

        .radio-option input[type="radio"]:checked+.radio-label .radio-indicator {
            border-color: var(--button-bg);
            background-color: var(--button-bg);
        }

        .radio-indicator::after {
            content: '';
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
            background-color: var(--button-text);
            opacity: 0;
            transform: scale(0);
            transition: all 0.2s ease;
        }

        .radio-option input[type="radio"]:checked+.radio-label .radio-indicator::after {
            opacity: 1;
            transform: scale(1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-item:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }

        .percentage {
            font-size: 3rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 0rem;
            letter-spacing: -0.03125rem;
        }

        .label {
            text-align: center;
            margin-bottom: 1rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 600;
            line-height: 1.4;
        }

        .grid {
            display: flex;
            flex-direction: column-reverse;
            gap: 0.375rem;
            margin-bottom: 1.25rem;
            width: 100%;
        }

        .grid-row {
            display: flex;
            gap: 0.375rem;
        }

        .square {
            flex: 1;
            aspect-ratio: 3;
            border-radius: 0.125rem;
            background-color: var(--bg-secondary);
            transition: background-color 0.3s ease;
        }

        .square.empty {
            background-color: var(--bg-square);
        }

        .square.animating {
            transition: background-color 0.15s ease-out, opacity 0.15s ease-out;
        }

        .total {
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            color: var(--text-secondary);
        }

        .total-label {
            text-align: center;
            margin-bottom: 1.25rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 600;
            line-height: 1.4;
        }

        #statsContainer {
            margin: auto;
        }

        .radio-group {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: repeat(2, auto);
            gap: 0.5rem;
            max-width: 1256px;
            margin: auto;
        }

        .sparkline-table-container {
            overflow-x: auto;
            margin-top: 1.5rem;
        }

        .sparkline-table-container h3 {
            margin-top: 1rem;
            text-align: center;
        }

        .sparkline-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
            overflow: hidden;
        }

        .sparkline-table caption {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-align: left;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--bg-secondary);
        }

        .sparkline-table thead {
            background-color: var(--bg-secondary);
        }

        .sparkline-table th {
            padding: 0.875rem 0.5rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s ease;
            position: relative;
            font-size: 0.8125rem;
        }

        .sparkline-table th:hover {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .sparkline-table th:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: -3px;
        }

        .sparkline-table th.sortable::after {
            content: '⇅';
            margin-left: 0.25rem;
            opacity: 0.5;
            font-size: 0.75rem;
        }

        .sparkline-table th.sorted-asc::after {
            content: '▲';
            opacity: 1;
        }

        .sparkline-table th.sorted-desc::after {
            content: '▼';
            opacity: 1;
        }

        .sparkline-table tbody tr {
            border-bottom: 1px solid var(--bg-secondary);
            transition: background-color 0.2s ease;
        }

        .sparkline-table tbody tr:hover {
            background-color: var(--bg-secondary);
        }

        .sparkline-table td {
            padding: 0.75rem 0.5rem;
            color: var(--text-secondary);
        }

        #sparklineTable:focus,
        #statusTableByState:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 0.25rem;
        }

        #sparklineTable td:focus,
        #statusTableByState td:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: -2px;
            background-color: var(--bg-secondary);
            position: relative;
            z-index: 1;
        }

        #sparklineTable td,
        #statusTableByState td {
            outline: none;
        }

        .estado-name {
            font-weight: 600;
            white-space: normal;
            min-width: 150px;
        }

        .total-museus {
            text-align: left;
            font-weight: 600;
            min-width: 60px;
        }

        .sparkline-cell {
            min-width: 140px;
        }

        .category-container {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .sparkline-mini-bar {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
        }

        .bar-visual {
            height: 0.875rem;
            border-radius: 0.25rem;
            transition: width 0.4s ease-out;
            min-width: 2px;
            flex-shrink: 0;
            max-width: 50%;
        }

        .bar-info {
            display: flex;
            align-items: baseline;
            gap: 0.375rem;
            font-size: 0.8125rem;
            white-space: nowrap;
            flex-shrink: 0;
            min-width: 120px;
        }

        .bar-visual.acessivel {
            background-color: #2d9f4f;
        }

        .bar-visual.parcial {
            background-color: #f5b800;
        }

        .bar-visual.sem-recursos {
            background-color: #e74c5c;
        }

        .bar-visual.insuficiente {
            background-color: #6b7885;
        }

        .bar-info {
            display: flex;
            align-items: baseline;
            gap: 0.375rem;
            font-size: 0.8125rem;
            white-space: nowrap;
        }

        .bar-percentage {
            font-weight: 600;
            min-width: 38px;
        }

        .bar-count {
            color: var(--text-secondary);
            opacity: 0.75;
            font-size: 0.75rem;
        }

        .sparkline-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            padding-top: 0.5rem;
            justify-content: center;
        }

        .legend-item-sparkline {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8125rem;
        }

        .legend-color {
            width: 1rem;
            height: 1rem;
            border-radius: 0.125rem;
        }

        .sort-announcement {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .show-more-container {
            text-align: center;
            margin-top: 1.5rem;
        }

        .show-more-button {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            padding: 0.75rem 2rem;
            font-size: 0.875rem;
            font-weight: 600;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .show-more-button:hover {
            opacity: 1;
        }

        .show-more-button:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }

        .hidden-row {
            display: none;
        }

        .bar-charts-wrapper {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .bar-chart-container {
            display: flex;
            flex-direction: column;
        }

        .bar-chart-title {
            color: var(--link);
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            text-align: center;
            min-height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bar-chart-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .bar-chart-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .bar-chart-item:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 0.25rem;
        }

        .bar-chart-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 1rem;
        }

        .bar-chart-label {
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--text-secondary);
            flex: 1;
        }

        .bar-chart-value {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .bar-chart-count {
            font-size: 0.875rem;
        }

        .bar-chart-percentage {
            font-size: 0.8125rem;
            opacity: 0.75;
        }

        .bar-chart-track {
            width: 100%;
            height: 2rem;
            background-color: var(--bar-bg);
            border-radius: 0.25rem;
            overflow: visible;
            position: relative;
        }

        .bar-chart-track:focus {
            outline: 2px solid var(--focus-outline);
            outline-offset: 2px;
        }

        .bar-chart-fill {
            height: 100%;
            background-color: var(--bar-color);
            border-radius: 0.25rem;
            transition: width 0.8s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 0;
            min-width: 0;
            width: 0%;
            position: relative;
        }

        .bar-chart-fill-text {
            color: var(--text-secondary);
            font-size: 0.8125rem;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s ease-in 0.8s;
            position: absolute;
            right: -3rem;
            white-space: nowrap;
        }

        .bar-chart-fill.animated .bar-chart-fill-text {
            opacity: 1;
            position: absolute;
            left: calc(100% + 0.75rem);
        }

        .sem-recursos .bar-chart-fill {
            background-color: #e74c5c;
        }

        .sem-info .bar-chart-fill {
            background-color: #6b7885;
        }

        body.dark-mode .sem-recursos .bar-chart-fill {
            background-color: #e74c5c;
        }

        body.dark-mode .sem-info .bar-chart-fill {
            background-color: #6b7885;
        }

        .dual-charts-wrapper {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .chart-total {
            font-size: 1rem;
            text-align: center;
            color: var(--text-secondary);
        }

        .chart-total strong {
            font-weight: 700;
            color: var(--link);
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin: 0 auto;
        }

        .status-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .status-item:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 0.25rem;
        }

        .status-title {
            font-size: 1.3rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 1.25rem;
            color: var(--link);
            min-height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .status-bar-container {
            width: 100%;
            margin-bottom: 1rem;
        }

        .status-stacked-bar {
            width: 100%;
            height: 3rem;
            display: flex;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .status-bar-segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            transition: all 0.8s ease-out;
            position: relative;
        }

        .status-bar-segment-text {
            opacity: 0;
            transition: opacity 0.3s ease-in 0.8s;
        }

        .status-bar-segment.animated .status-bar-segment-text {
            opacity: 1;
        }

        .bar-aberto {
            background-color: #1351b4;
        }

        body.dark-mode .bar-aberto {
            background-color: #4a90e2;
        }

        .bar-fechado {
            background-color: #ff6b35;
        }

        body.dark-mode .bar-fechado {
            background-color: #ff8c42;
        }

        .status-details {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .status-detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
        }

        .status-detail-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .status-detail-color {
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 0.125rem;
        }

        .status-detail-value {
            font-weight: 700;
            color: var(--text-secondary);
        }

        .status-detail-value span {
            font-weight: 400;
            font-size: 0.875rem;
        }

        .status-total-line {
            width: 100%;
            padding-top: 0.75rem;
            border-top: 2px solid var(--bg-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9375rem;
        }

        .status-total-label {
            font-weight: 700;
            color: var(--link);
        }

        .status-total-value {
            font-weight: 700;
            font-size: 1.125rem;
            color: var(--text-secondary);
        }

        .status-legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .status-legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9375rem;
            font-weight: 600;
        }

        .status-legend-color {
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 0.25rem;
        }

        #statusTableBody .bar-visual.acessivel {
            background-color: #1351b4;
        }

        body.dark-mode #statusTableBody .bar-visual.acessivel {
            background-color: #4a90e2;
        }

        #statusTableBody .bar-visual.sem-recursos {
            background-color: #ff6b35;
        }

        body.dark-mode #statusTableBody .bar-visual.sem-recursos {
            background-color: #ff8c42;
        }

        .tematicas-table-container {
            overflow-x: auto;
            margin-top: 2rem;
        }

        .tematicas-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .tematicas-table thead {
            background-color: var(--bg-secondary);
        }

        .tematicas-table th {
            padding: 0.875rem 0.5rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 2px solid var(--bg-secondary);
            font-size: 0.8125rem;
        }

        .tematicas-table th.col-tematica {
            min-width: 200px;
        }

        .tematicas-table th.col-total {
            text-align: center;
            min-width: 80px;
        }

        .tematicas-table th.col-esfera {
            text-align: center;
            min-width: 100px;
        }

        .tematicas-table tbody tr {
            border-bottom: 1px solid var(--bg-secondary);
            transition: background-color 0.2s ease;
        }

        .tematicas-table tbody tr:hover {
            background-color: var(--bg-secondary);
        }

        .tematicas-table tbody tr.total-row {
            background-color: var(--bg-secondary);
            font-weight: 700;
        }

        .tematicas-table td {
            padding: 0.75rem 0.5rem;
            color: var(--text-secondary);
        }

        .tematicas-table td.col-tematica {
            font-weight: 600;
        }

        .tematica-cell {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .tematica-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .tematica-label {
            flex: 1;
        }

        .tematica-bar-container {
            width: 100%;
            height: 1.5rem;
            background-color: var(--bg-secondary);
            border-radius: 0.25rem;
            overflow: visible;
            position: relative;
        }

        .tematica-bar-fill {
            height: 100%;
            border-radius: 0.25rem;
            transition: width 0.8s ease-out;
            width: 0%;
            display: flex;
            align-items: center;
            padding: 0 0.5rem;
            position: relative;
        }

        .tematica-bar-fill.animated {
            width: var(--bar-width);
        }

        .tematica-bar-text {
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            position: absolute;
            left: 0.5rem;
        }

        .tematica-bar-fill[data-small="true"] .tematica-bar-text {
            left: calc(100% + 0.5rem);
            color: var(--text-secondary);
        }

        .tematicas-table td.col-total {
            text-align: center;
            font-weight: 700;
        }

        .total-cell {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }

        .total-count {
            font-weight: 500;
            font-size: 0.9375rem;
        }

        .total-percentage {
            font-size: 0.75rem;
            opacity: 0.75;
            font-weight: 400;
        }

        .tematicas-table td.col-esfera {
            text-align: center;
        }

        .esfera-cell {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }

        .esfera-count {
            font-weight: 600;
            font-size: 0.875rem;
        }

        .esfera-percentage {
            font-size: 0.75rem;
            opacity: 0.75;
            font-weight: 400;
        }

        .tematicas-table {
            position: relative;
        }

        .tematicas-table:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 0.25rem;
        }

        .tematicas-table td:focus,
        .tematicas-table th:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: -2px;
            background-color: var(--bg-secondary);
            position: relative;
            z-index: 1;
        }

        .tematicas-table td,
        .tematicas-table th {
            outline: none;
        }

        .tematicas-announcement {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .tematicas-table tbody tr:focus-within {
            background-color: var(--bg-secondary);
        }

        .tematicas-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s ease;
            position: relative;
        }

        .tematicas-table th.sortable:hover {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        .tematicas-table th.sortable::after {
            content: '⇅';
            margin-left: 0.25rem;
            opacity: 0.5;
            font-size: 0.75rem;
        }

        .tematicas-table th.sorted-asc::after {
            content: '▲';
            opacity: 1;
        }

        .tematicas-table th.sorted-desc::after {
            content: '▼';
            opacity: 1;
        }

        .dark-mode-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
        }

        .visitas-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .visita-card {
            background: var(--content-bg);
            border: 2px solid var(--bg-secondary);
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: default;
        }

        .visita-card:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-color: var(--link);
        }

        .visita-card-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            line-height: 1;
        }

        .visita-card-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .visita-card-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--link);
            line-height: 1;
            margin-bottom: 0.25rem;
        }

        .visita-card-percentage {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-secondary);
            opacity: 0.7;
        }

        .visita-card-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .visitas-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .visitas-legend .legend-item-visitas {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .visitas-legend .legend-color-visitas {
            width: 1rem;
            height: 1rem;
            border-radius: 0.125rem;
            flex-shrink: 0;
        }

        .visitas-stacked-bars {
            margin: 0 auto;
        }

        .visita-bar-item {
            margin-bottom: 2rem;
        }

        .visita-bar-item:focus {
            outline: none;
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-color: var(--link);
        }

        .visita-bar-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 0.75rem;
            gap: 1rem;
        }

        .visita-bar-label {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            flex: 1;
        }

        .visita-bar-total {
            font-size: 0.875rem;
            color: var(--text-secondary);
            opacity: 0.75;
            white-space: nowrap;
        }

        .visita-stacked-bar {
            width: 100%;
            height: 3.5rem;
            display: flex;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .visita-bar-segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.8s ease-out;
            position: relative;
            color: white;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .visita-bar-segment-text {
            opacity: 0;
            transition: opacity 0.3s ease-in 0.8s;
            white-space: nowrap;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .visita-bar-segment.animated .visita-bar-segment-text {
            opacity: 1;
        }

        .visita-bar-segment[data-small="true"] .visita-bar-segment-text {
            display: none;
        }

        .visita-bar-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 0.5rem;
        }

        .visita-detail-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .visita-detail-color {
            width: 0.875rem;
            height: 0.875rem;
            border-radius: 0.125rem;
            flex-shrink: 0;
        }

        .visita-detail-esfera {
            color: var(--text-secondary);
            font-weight: 600;
        }

        .visita-detail-count {
            color: var(--text-secondary);
            font-weight: 700;
        }

        .visita-detail-perc {
            color: var(--text-secondary);
            opacity: 0.75;
            font-weight: 500;
        }

        .visita-bar-segment.esfera-publica,
        .visita-detail-color.esfera-publica {
            background-color: #1351b4;
        }

        body.dark-mode .visita-bar-segment.esfera-publica,
        body.dark-mode .visita-detail-color.esfera-publica {
            background-color: #4a90e2;
        }

        .visita-bar-segment.esfera-privada,
        .visita-detail-color.esfera-privada {
            background-color: #ff8c00;
        }

        .visita-bar-segment.esfera-particular,
        .visita-detail-color.esfera-particular {
            background-color: #2a9d8f;
        }

        .visita-bar-segment.esfera-mista,
        .visita-detail-color.esfera-mista {
            background-color: #e85d04;
        }

        .visita-bar-segment.esfera-nao-informado,
        .visita-detail-color.esfera-nao-informado {
            background-color: #6b7885;
        }

        .entrada-cards-wrapper {
            margin: 0 auto;
        }

        .entrada-cards-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .entrada-cards-container .entrada-card:nth-child(4),
        .entrada-cards-container .entrada-card:nth-child(5) {
            grid-column: span 1;
        }

        .entrada-cards-container::after {
            content: '';
            grid-column: 1 / -1;
            display: contents;
        }

        .entrada-card {
            background: var(--content-bg);
            border: 2px solid var(--bg-secondary);
            border-radius: 0.75rem;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }

        .entrada-card:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
        }

        .entrada-card-header {
            text-align: center;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--bg-secondary);
            margin-bottom: 1rem;
        }

        .entrada-card-title {
            font-size: 0.9375rem;
            font-weight: 700;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            min-height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            line-height: 1.3;
        }

        .entrada-card-percentage {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--link);
            line-height: 1;
            margin-bottom: 0.5rem;
        }

        .entrada-card-total {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .entrada-card-total-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .entrada-card-chart {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .entrada-chart-item {
            display: flex;
            flex-direction: column;
            gap: 0.375rem;
        }

        .entrada-chart-label {
            font-size: 0.8125rem;
            color: var(--text-secondary);
            margin-bottom: 0.375rem;
        }

        .entrada-chart-esfera {
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
        }

        .entrada-chart-value {
            font-weight: 600;
            white-space: nowrap;
        }

        .entrada-chart-bar-container {
            width: 100%;
            height: 1.5rem;
            background-color: var(--bg-secondary);
            border-radius: 0.25rem;
            overflow: hidden;
            position: relative;
        }

        .entrada-chart-bar {
            height: 100%;
            border-radius: 0.25rem;
            transition: width 0.8s ease-out;
            width: 0%;
            display: flex;
            align-items: center;
            padding: 0 0.5rem;
            position: relative;
        }

        .entrada-chart-bar.animated {
            width: var(--bar-width);
        }

        .entrada-chart-bar-text {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            white-space: nowrap;
            position: absolute;
            left: calc(100% + 0.5rem);
            opacity: 0;
            transition: opacity 0.3s ease-in 0.8s;
        }

        .entrada-chart-bar.animated .entrada-chart-bar-text {
            opacity: 1;
        }

        #sparklineTable:focus,
        #statusTableByState:focus,
        #entradaTableByState:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 0.25rem;
        }

        #sparklineTable td:focus,
        #statusTableByState td:focus,
        #entradaTableByState td:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: -2px;
            background-color: var(--bg-secondary);
            position: relative;
            z-index: 1;
        }

        #sparklineTable td,
        #statusTableByState td,
        #entradaTableByState td {
            outline: none;
        }

        .entrada-chart-bar.esfera-publica {
            background-color: #1351b4;
        }

        body.dark-mode .entrada-chart-bar.esfera-publica {
            background-color: #4a90e2;
        }

        .entrada-chart-bar.esfera-privada {
            background-color: #ff8c00;
        }

        .entrada-chart-bar.esfera-particular {
            background-color: #2a9d8f;
        }

        .entrada-chart-bar.esfera-mista {
            background-color: #e85d04;
        }

        .entrada-chart-bar.esfera-nao-informado {
            background-color: #6b7885;
        }

        #entradaTableBody .bar-visual.nao-cobra {
            background-color: #2d9f4f;
        }

        body.dark-mode #entradaTableBody .bar-visual.nao-cobra {
            background-color: #3db55f;
        }

        #entradaTableBody .bar-visual.cobra {
            background-color: #e74c5c;
        }

        body.dark-mode #entradaTableBody .bar-visual.cobra {
            background-color: #f25c6c;
        }

        #entradaTableBody .bar-visual.contribuicao {
            background-color: #f5b800;
        }

        body.dark-mode #entradaTableBody .bar-visual.contribuicao {
            background-color: #ffc520;
        }

        #entradaTableBody .bar-visual.nao-informado {
            background-color: #6b7885;
        }

        body.dark-mode #entradaTableBody .bar-visual.nao-informado {
            background-color: #8b97a5;
        }

        #entradaTableBody .bar-visual.nao-disponivel {
            background-color: #95a5a6;
        }

        body.dark-mode #entradaTableBody .bar-visual.nao-disponivel {
            background-color: #b5c5c6;
        }

        .digital-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin: 0 auto;
        }

        .digital-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .digital-item:focus {
            outline: 3px solid var(--focus-outline);
            outline-offset: 2px;
            border-radius: 0.25rem;
        }

        .digital-title {
            font-size: 1.1rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 1.25rem;
            color: var(--link);
            min-height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .digital-bar-container {
            width: 100%;
            margin-bottom: 1rem;
        }

        .digital-stacked-bar {
            width: 100%;
            height: 3rem;
            display: flex;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .digital-bar-segment {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            color: white;
            transition: all 0.8s ease-out;
            position: relative;
        }

        .digital-bar-segment-text {
            opacity: 0;
            transition: opacity 0.3s ease-in 0.8s;
        }

        .digital-bar-segment.animated .digital-bar-segment-text {
            opacity: 1;
        }

        .bar-possui {
            background-color: #2d9f4f;
        }

        body.dark-mode .bar-possui {
            background-color: #3db55f;
        }

        .bar-nao-possui {
            background-color: #e74c5c;
        }

        body.dark-mode .bar-nao-possui {
            background-color: #f25c6c;
        }

        .digital-details {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .digital-detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
        }

        .digital-detail-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .digital-detail-color {
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 0.125rem;
        }

        .digital-detail-value {
            font-weight: 700;
            color: var(--text-secondary);
        }

        .digital-detail-value span {
            font-weight: 400;
            font-size: 0.875rem;
        }

        .digital-total-line {
            width: 100%;
            padding-top: 0.75rem;
            border-top: 2px solid var(--bg-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9375rem;
        }

        .digital-total-label {
            font-weight: 700;
            color: var(--link);
        }

        .digital-total-value {
            font-weight: 700;
            font-size: 1.125rem;
            color: var(--text-secondary);
        }

        .digital-legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .digital-legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9375rem;
            font-weight: 600;
        }

        .digital-legend-color {
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 0.25rem;
        }


        .guima-note-title {
            color: var(--link);
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .note {
            margin: 1.5rem auto 0.5rem;
            padding: 0.5rem 2rem;
        }

        a {
            color: var(--link);
        }
        
        .link-footer {
            color: var(--button-text);
        }

        @media (max-width: 1024px) {

            .top-header,
            .main-header {
                padding: 1rem 1.25rem;
            }

            .top-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .site-title {
                font-size: 0.75rem;
            }

            .accessibility-controls {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                width: 100%;
                gap: 0.75rem;
                position: relative;
            }

            .accessibility-controls .skip-link {
                position: absolute;
                left: -9999px;
            }

            .accessibility-controls .skip-link:focus {
                position: absolute;
                left: auto;
                top: -0.5rem;
                z-index: 10001;
                background: var(--button-bg);
                color: var(--button-text);
                padding: 0.5rem 1rem;
                border-radius: 0.25rem;
                width: 100%;
            }

            .main-header {
                flex-direction: column;
                gap: 1.5rem;
            }

            .logo {
                font-size: 3rem;
            }

            .main-nav {
                flex-direction: column;
                width: 100%;
                gap: 0.625rem;
            }

            .nav-button {
                width: 100%;
                text-align: center;
                padding: 0.75rem 1.25rem;
            }

            .footer {
                padding: 0.75rem 1.25rem;
            }

            .content-area {
                padding: 0.5rem;
            }

            .article-section {
                padding: 1.5rem;
            }

            .stats-card {
                padding: 1.5rem;
            }

            .radio-group {
                display: grid;
                grid-template-columns: 1fr 1fr;
                grid-template-rows: repeat(3, auto);
                gap: 0.5rem;
            }

            .radio-label {
                justify-content: flex-start;
                width: 100%;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 2rem;
            }

            .percentage {
                font-size: 2.5rem;
            }

            .total {
                font-size: 1.75rem;
            }

            .grid {
                gap: 0.25rem;
            }

            .grid-row {
                gap: 0.25rem;
            }

            .sparkline-table {
                font-size: 0.75rem;
            }

            .sparkline-table th,
            .sparkline-table td {
                padding: 0.625rem 0.375rem;
            }

            .bar-info {
                font-size: 0.75rem;
            }

            .bar-count {
                font-size: 0.6875rem;
            }

            .sparkline-cell {
                min-width: 120px;
            }

            .bar-visual {
                height: 1.5rem;
            }

            .sparkline-table thead {
                display: none;
            }

            .sparkline-table tbody tr {
                display: grid;
                grid-template-columns: 1fr 1fr;
                grid-template-rows: auto auto;
                gap: 0.75rem;
                margin-bottom: 1rem;
                padding: 1rem;
                border: 1px solid var(--bg-secondary);
                border-radius: 0.5rem;
                background-color: var(--content-bg);
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .sparkline-table tbody tr:hover {
                background-color: var(--content-bg);
            }

            .sparkline-table td {
                padding: 0;
                border: none;
            }

            .estado-name {
                font-size: 1.3rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }


            .total-museus {
                font-size: 1rem;
                font-weight: 500;
                text-align: left;
                margin-top: 0.25rem;
            }

            .total-museus::after {
                content: ' museus';
                font-weight: 500;
            }

            .total-museus::before {
                content: 'Total de ';
                font-weight: 500;
            }

            .sparkline-cell:nth-of-type(3) {
                grid-column: 1;
                grid-row: 2;
            }

            .sparkline-cell:nth-of-type(4) {
                grid-column: 2;
                grid-row: 2;
            }

            .sparkline-cell:nth-of-type(5) {
                grid-column: 1;
                grid-row: 3;
            }

            .sparkline-cell:nth-of-type(6) {
                grid-column: 2;
                grid-row: 3;
            }

            .sparkline-cell {
                min-width: auto;
            }

            #sparklineTableBody tr.hidden-row,
            #statusTableBody tr.hidden-row {
                display: none !important;
            }

            #statusTableBody tr:not(.hidden-row) {
                display: grid !important;
            }

            .sparkline-cell::before {
                content: attr(data-label);
                display: block;
                font-weight: 600;
                font-size: 0.8rem;
                color: var(--link);
                margin-bottom: 0.25rem;
            }

            .bar-percentage {
                min-width: auto;
                font-size: 0.85rem;
                font-weight: 500;
            }

            .bar-count {
                display: inline;
                font-size: 0.6875rem;
            }

            .bar-charts-wrapper {
                grid-template-columns: 1fr;
                gap: 3rem;
            }

            .bar-chart-title {
                font-size: 1rem;
                min-height: auto;
            }

            .bar-chart-label {
                font-size: 0.875rem;
            }

            .bar-chart-value {
                font-size: 0.8125rem;
            }

            .bar-chart-track {
                height: 2rem;
            }

            .bar-chart-fill-text {
                font-size: 0.85rem;
                right: -2.5rem;
            }

            .dual-charts-wrapper {
                grid-template-columns: 1fr;
                gap: 3rem;
            }

            .chart-total {
                font-size: 0.9375rem;
            }

            .status-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 2rem;
            }

            .status-title {
                font-size: 1.2rem;
                min-height: 2rem;
            }

            .status-stacked-bar {
                height: 2.5rem;
            }

            .status-bar-segment {
                font-size: 0.75rem;
            }

            .status-detail-item {
                font-size: 0.8125rem;
            }

            .status-total-line {
                font-size: 0.875rem;
            }

            .status-total-value {
                font-size: 1rem;
            }

            .tematicas-table thead {
                display: none;
            }

            .tematicas-table tbody {
                display: block;
            }

            .tematicas-table tbody tr {
                display: block;
                margin-bottom: 1.5rem;
                padding: 1.25rem;
                border: 1px solid var(--bg-secondary);
                border-radius: 0.5rem;
                background-color: var(--content-bg);
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }

            .tematicas-table tbody tr:hover {
                background-color: var(--content-bg);
            }

            .tematicas-table tbody tr.total-row {
                background-color: var(--bg-secondary);
            }

            .tematicas-table td {
                display: block;
                padding: 0;
                border: none;
                text-align: left !important;
            }

            .tematicas-table td::before {
                content: attr(data-label);
                display: block;
                font-weight: 600;
                font-size: 0.75rem;
                color: var(--link);
                margin-bottom: 0.5rem;
                text-transform: uppercase;
                letter-spacing: 0.025rem;
            }

            .tematicas-table td.col-tematica {
                font-size: 1.125rem;
                border-bottom: 2px solid var(--bg-secondary);
                padding-bottom: 1rem;
                margin-bottom: 0.5rem;
            }

            .tematicas-table td.col-tematica::before {
                display: none;
            }

            .tematica-header {
                gap: 1rem;
            }

            .tematica-label {
                font-size: 1.125rem;
            }

            .tematica-bar-container {
                height: 1.75rem;
            }

            .card-row-1,
            .card-row-2 {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 0.75rem;
            }

            .card-row-1 {
                margin-bottom: 0.75rem;
            }

            .tematicas-table td.col-total {
                font-size: inherit;
            }

            .total-cell {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.25rem;
            }

            .total-count {
                font-size: 0.9375rem;
                font-weight: 500;
            }

            .total-percentage {
                font-size: 0.8125rem;
                font-weight: 400;
            }

            .tematicas-table td.col-esfera {
                padding: 0;
            }

            .esfera-cell {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.25rem;
            }

            .esfera-count {
                font-size: 0.9375rem;
            }

            .esfera-percentage {
                font-size: 0.8125rem;
                font-weight: 400;
            }

            .tematicas-table tbody tr.total-row td.col-tematica {
                font-size: 1.25rem;
                color: var(--link);
            }

            .visitas-cards-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .visita-card {
                padding: 1.25rem 1rem;
            }

            .visita-card-icon {
                font-size: 2rem;
            }

            .visita-card-number {
                font-size: 1.75rem;
            }

            .visita-card-percentage {
                font-size: 1.125rem;
            }

            .visita-stacked-bar {
                height: 3rem;
            }

            .visita-bar-segment {
                font-size: 0.75rem;
            }

            .visita-bar-details {
                flex-direction: column;
                gap: 0.75rem;
            }

            .visita-detail-item {
                font-size: 0.8125rem;
            }

            .visitas-legend {
                gap: 1rem;
            }

            .entrada-cards-container {
                grid-template-columns: 1fr;
                gap: 1.25rem;
            }

            .entrada-cards-container .entrada-card:nth-child(4),
            .entrada-cards-container .entrada-card:nth-child(5) {
                grid-column: span 1;
            }

            .entrada-card {
                padding: 1.25rem;
            }

            .entrada-card-percentage {
                font-size: 2.25rem;
            }

            .entrada-chart-bar-container {
                height: 1.75rem;
            }

            .entrada-card-title {
                font-size: 0.875rem;
                min-height: 2rem;
            }

            .entrada-card-percentage {
                font-size: 2rem;
            }

            .entrada-chart-label {
                font-size: 0.75rem;
            }

            .entrada-chart-bar-container {
                height: 1.5rem;
            }

            #sparklineTableBody tr.hidden-row,
            #statusTableBody tr.hidden-row,
            #entradaTableBody tr.hidden-row {
                display: none !important;
            }

            .show-more-container {
                padding: 0 1rem;
            }

            .show-more-button {
                width: 100%;
                max-width: 400px;
                margin: 0 auto;
                display: block;
            }

            .digital-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 2rem;
            }

            .digital-title {
                font-size: 1rem;
                min-height: 2rem;
            }

            .digital-stacked-bar {
                height: 2.5rem;
            }

            .digital-bar-segment {
                font-size: 0.7rem;
            }

            .digital-detail-item {
                font-size: 0.8125rem;
            }

            .digital-total-line {
                font-size: 0.875rem;
            }

            .digital-total-value {
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="top-header">
            <h1 class="site-title">GUIA DE MUSEUS ACESSÍVEIS DO BRASIL</h1>
            <nav class="accessibility-controls" aria-label="Controles de acessibilidade">
                <a href="#main-content" class="skip-link" tabindex="0">Ir para o conteúdo</a>
                <button id="darkModeToggle" tabindex="0" aria-label="Alternar modo escuro">🌙 Modo escuro</button>
                <button id="increaseText" tabindex="0" aria-label="Aumentar tamanho do texto">🔼 Aumentar texto</button>
                <button id="decreaseText" tabindex="0" aria-label="Diminuir tamanho do texto">🔽 Diminuir texto</button>
            </nav>
        </div>

        <div class="main-header">
            <a href="index.html" class="logo" tabindex="0" aria-label="Guima - Página inicial">GuiMA</a>
            <nav id="main-nav" class="main-nav" aria-label="Menu principal">
                <a href="index.html" class="nav-button" tabindex="0">Mapa de museus</a>
                <a href="dados.html" class="nav-button active" tabindex="0">Visualização de dados</a>
                <a href="metodologia.html" class="nav-button" tabindex="0">Sobre o projeto</a>
            </nav>
        </div>
    </header>

    <main id="main-content" class="content-area">
        <article>
            <section class="article-section">
                <h2 class="card-title">Porcentagem de museus com acessibilidade no Brasil</h2>

                <div class="filter-section">
                    <p class="filter-description">
                        Selecione a esfera do museu para consultar a completude das informações oficiais sobre
                        acessibilidade.
                    </p>

                    <div class="radio-group" role="radiogroup" aria-label="Esfera do museu">
                        <div class="radio-option">
                            <input type="radio" id="sphere-todos" name="sphere" value="todos" checked>
                            <label for="sphere-todos" class="radio-label">
                                <span class="radio-indicator"></span>
                                <span><strong>Todos cadastrados</strong> (4024 museus)</span>
                            </label>
                        </div>

                        <div class="radio-option">
                            <input type="radio" id="sphere-publica" name="sphere" value="publica">
                            <label for="sphere-publica" class="radio-label">
                                <span class="radio-indicator"></span>
                                <span><strong>Esfera Pública</strong> (2616 museus)</span>
                            </label>
                        </div>

                        <div class="radio-option">
                            <input type="radio" id="sphere-privada" name="sphere" value="privada">
                            <label for="sphere-privada" class="radio-label">
                                <span class="radio-indicator"></span>
                                <span><strong>Esfera Privada</strong> (1183 museus)</span>
                            </label>
                        </div>

                        <div class="radio-option">
                            <input type="radio" id="sphere-particular" name="sphere" value="particular">
                            <label for="sphere-particular" class="radio-label">
                                <span class="radio-indicator"></span>
                                <span><strong>Museus Particulares</strong> (141 museus)</span>
                            </label>
                        </div>

                        <div class="radio-option">
                            <input type="radio" id="sphere-mista" name="sphere" value="mista">
                            <label for="sphere-mista" class="radio-label">
                                <span class="radio-indicator"></span>
                                <span><strong>Esfera Mista</strong> (23 museus)</span>
                            </label>
                        </div>

                        <div class="radio-option">
                            <input type="radio" id="sphere-nao-informada" name="sphere" value="nao-informada">
                            <label for="sphere-nao-informada" class="radio-label">
                                <span class="radio-indicator"></span>
                                <span><strong>Sem informação na base</strong> (61 museus)</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div id="statsContainer" class="stats-grid" role="region" aria-label="Estatísticas visuais"
                    aria-live="polite"></div>
            </section>

            <section class="article-section">
                <h2>Acessibilidade dos museus por estado</h2>
                <p class="filter-description">Classificação dos 4.024 museus de acordo com os recursos e infraestrutura
                    que apresentam.</p>
                <div id="sortAnnouncement" class="sort-announcement" role="status" aria-live="polite"
                    aria-atomic="true"></div>
                </div>

                <div class="sparkline-table-container">
                    <table class="sparkline-table" id="sparklineTable" tabindex="0">
                        <thead>
                            <tr>
                                <th scope="col" class="sortable" data-sort="estado" tabindex="-1" role="button"
                                    aria-label="Ordenar por estado">
                                    Estado
                                </th>
                                <th scope="col" class="sortable" data-sort="total" tabindex="-1" role="button"
                                    aria-label="Ordenar por total de museus">
                                    Total
                                </th>
                                <th scope="col" class="sortable" data-sort="acessivel" tabindex="-1" role="button"
                                    aria-label="Ordenar por acessíveis">
                                    Acessível
                                </th>
                                <th scope="col" class="sortable" data-sort="parcial" tabindex="-1" role="button"
                                    aria-label="Ordenar por parcialmente acessíveis">
                                    Parcial
                                </th>
                                <th scope="col" class="sortable" data-sort="sem" tabindex="-1" role="button"
                                    aria-label="Ordenar por sem recursos">
                                    Sem recursos
                                </th>
                                <th scope="col" class="sortable" data-sort="insuf" tabindex="-1" role="button"
                                    aria-label="Ordenar por informação insuficiente">
                                    Sem informação
                                </th>
                            </tr>
                        </thead>
                        <tbody id="sparklineTableBody">

                        </tbody>
                    </table>
                </div>

                <div class="show-more-container">
                    <button id="showMoreButton" class="show-more-button" type="button">
                        Exibir todos os estados
                    </button>
                </div>

            </section>

            <section class="article-section">
                <h2>Principais recursos e infraestrutura de acessibilidade</h2>
                <p class="filter-description">Os 5 principais itens de acessbilidade indicados pelos 4.024 museus
                    registrados (excluindo registros preenchidos com "Não informado" e "Não possui")</p>

                <div class="bar-charts-wrapper">
                    <div class="bar-chart-container">
                        <h3 class="bar-chart-title">Para dificuldade de locomoção</h3>
                        <div class="bar-chart-list" role="list"
                            aria-label="Ranking dos 5 principais recursos para dificuldade de locomoção">
                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">1. Rampas de acesso</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="1º lugar: Rampas de acesso com 996 museus, representando 24.75%">
                                    <div class="bar-chart-fill" data-percentage="24.75" data-count="996">
                                        <span class="bar-chart-fill-text">24.75%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">2. Banheiros adaptados</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="2º lugar: Banheiros adaptados com 871 museus, representando 21.65%">
                                    <div class="bar-chart-fill" data-percentage="21.65" data-count="871">
                                        <span class="bar-chart-fill-text">21.65%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">3. Corrimão nas escadas e rampas</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="3º lugar: Corrimão nas escadas e rampas com 761 museus, representando 18.91%">
                                    <div class="bar-chart-fill" data-percentage="18.91" data-count="761">
                                        <span class="bar-chart-fill-text">18.91%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">4. Vaga para idosos</span>
                                </div>
                                <div class="bar-chart-track" role="img"
                                    aria-label="4º lugar: Vaga para idosos com 596 museus, representando 14.81%">
                                    <div class="bar-chart-fill" data-percentage="14.81" data-count="596">
                                        <span class="bar-chart-fill-text">14.81%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">5. Vaga para deficientes</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="5º lugar: Vaga para deficientes com 594 museus, representando 14.76%">
                                    <div class="bar-chart-fill" data-percentage="14.76" data-count="594">
                                        <span class="bar-chart-fill-text">14.76%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bar-chart-container">
                        <h3 class="bar-chart-title">Para deficiência visual e auditiva</h3>
                        <div class="bar-chart-list" role="list"
                            aria-label="Ranking dos 5 principais recursos para deficiência visual e auditiva">
                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">1. Material tátil</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="1º lugar: Material tátil com 195 museus, representando 4.85%">
                                    <div class="bar-chart-fill" data-percentage="4.85" data-count="195">
                                        <span class="bar-chart-fill-text">4.85%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">2. Sinalização tátil</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="2º lugar: Sinalização tátil com 169 museus, representando 4.2%">
                                    <div class="bar-chart-fill" data-percentage="4.2" data-count="169">
                                        <span class="bar-chart-fill-text">4.2%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">3. Tradutor de LIBRAS</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="3º lugar: Tradutor de LIBRAS com 150 museus, representando 3.73%">
                                    <div class="bar-chart-fill" data-percentage="3.73" data-count="150">
                                        <span class="bar-chart-fill-text">3.73%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">4. Material em Braille</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="4º lugar: Material em Braille com 128 museus, representando 3.18%">
                                    <div class="bar-chart-fill" data-percentage="3.18" data-count="128">
                                        <span class="bar-chart-fill-text">3.18%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">5. Audioguia</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="5º lugar: Audioguia com 108 museus, representando 2.68%">
                                    <div class="bar-chart-fill" data-percentage="2.68" data-count="108">
                                        <span class="bar-chart-fill-text">2.68%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bar-chart-container">
                        <h3 class="bar-chart-title">Para pessoa estrangeira</h3>
                        <div class="bar-chart-list" role="list"
                            aria-label="Ranking dos 5 principais recursos para pessoa estrangeira">
                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">1. Guia/Monitor</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="1º lugar: Guia/Monitor com 604 museus, representando 15.02%">
                                    <div class="bar-chart-fill" data-percentage="15.02" data-count="604">
                                        <span class="bar-chart-fill-text">15.02%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">2. Material impresso</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="2º lugar: Material impresso com 332 museus, representando 8.25%">
                                    <div class="bar-chart-fill" data-percentage="8.25" data-count="332">
                                        <span class="bar-chart-fill-text">8.25%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">3. Sinalização visual</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="3º lugar: Sinalização visual com 302 museus, representando 7.5%">
                                    <div class="bar-chart-fill" data-percentage="7.5" data-count="302">
                                        <span class="bar-chart-fill-text">7.5%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">4. Audioguia</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="4º lugar: Audioguia com 76 museus, representando 1.89%">
                                    <div class="bar-chart-fill" data-percentage="1.89" data-count="76">
                                        <span class="bar-chart-fill-text">1.89%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bar-chart-item" role="listitem">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label">5. Site em outros idiomas</span>
                                </div>
                                <div class="bar-chart-track" role="img" tabindex="0"
                                    aria-label="5º lugar: Site em outros idiomas com 27 museus, representando 0.67%">
                                    <div class="bar-chart-fill" data-percentage="0.67" data-count="27">
                                        <span class="bar-chart-fill-text">0.67%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="article-section">
                <h2>Museus sem recursos ou sem informação</h2>
                <p class="filter-description">Divisão por esferas dos museus que estão cadastrados mas que não possuem
                    recursos ou infraestrutura para acessibilidade ou que não informaram esses dados.</p>
                <div class="dual-charts-wrapper">
                    <div class="bar-chart-container">
                        <h3 class="bar-chart-title">Museus sem recursos de acessibilidade</h3>
                        <div class="chart-total">
                            <strong>Total:</strong> 1.182 museus (29.37%) de 4.024
                        </div>
                        <div class="bar-chart-list sem-recursos" role="list"
                            aria-label="Museus sem recursos de acessibilidade por esfera">
                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-sem-publica">Pública</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-sem-publica"
                                    aria-describedby="desc-sem-publica">
                                    <div class="bar-chart-fill" data-percentage="20.78" data-count="836">
                                        <span class="bar-chart-fill-text" aria-hidden="true">20.78%</span>
                                    </div>
                                </div>
                                <span id="desc-sem-publica" class="visually-hidden">836 museus, representando 20.78% do
                                    total</span>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-sem-privada">Privada</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-sem-privada"
                                    aria-describedby="desc-sem-privada">
                                    <div class="bar-chart-fill" data-percentage="6.96" data-count="280">
                                        <span class="bar-chart-fill-text" aria-hidden="true">6.96%</span>
                                    </div>
                                </div>
                                <span id="desc-sem-privada" class="visually-hidden">280 museus, representando 6.96% do
                                    total</span>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-sem-particular">Particular</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-sem-particular"
                                    aria-describedby="desc-sem-particular">
                                    <div class="bar-chart-fill" data-percentage="1.17" data-count="47">
                                        <span class="bar-chart-fill-text" aria-hidden="true">1.17%</span>
                                    </div>
                                </div>
                                <span id="desc-sem-particular" class="visually-hidden">47 museus, representando 1.17% do
                                    total</span>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-sem-naoinfo">Não informado</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-sem-naoinfo"
                                    aria-describedby="desc-sem-naoinfo">
                                    <div class="bar-chart-fill" data-percentage="0.37" data-count="15">
                                        <span class="bar-chart-fill-text" aria-hidden="true">0.37%</span>
                                    </div>
                                </div>
                                <span id="desc-sem-naoinfo" class="visually-hidden">15 museus, representando 0.37% do
                                    total</span>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-sem-mista">Mista</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-sem-mista"
                                    aria-describedby="desc-sem-mista">
                                    <div class="bar-chart-fill" data-percentage="0.1" data-count="4">
                                        <span class="bar-chart-fill-text" aria-hidden="true">0.1%</span>
                                    </div>
                                </div>
                                <span id="desc-sem-mista" class="visually-hidden">4 museus, representando 0.1% do
                                    total</span>
                            </div>
                        </div>
                    </div>

                    <div class="bar-chart-container">
                        <h3 class="bar-chart-title">Museus sem informação</h3>
                        <div class="chart-total">
                            <strong>Total:</strong> 1.118 museus (27.78%) de 4.024
                        </div>
                        <div class="bar-chart-list sem-info" role="list" aria-label="Museus sem informação por esfera">
                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-insuf-publica">Pública</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-insuf-publica"
                                    aria-describedby="desc-insuf-publica">
                                    <div class="bar-chart-fill" data-percentage="15.26" data-count="614">
                                        <span class="bar-chart-fill-text" aria-hidden="true">15.26%</span>
                                    </div>
                                </div>
                                <span id="desc-insuf-publica" class="visually-hidden">614 museus, representando 15.26%
                                    do total</span>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-insuf-privada">Privada</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-insuf-privada"
                                    aria-describedby="desc-insuf-privada">
                                    <div class="bar-chart-fill" data-percentage="10.83" data-count="436">
                                        <span class="bar-chart-fill-text" aria-hidden="true">10.83%</span>
                                    </div>
                                </div>
                                <span id="desc-insuf-privada" class="visually-hidden">436 museus, representando 10.83%
                                    do total</span>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-insuf-naoinfo">Não informado</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-insuf-naoinfo"
                                    aria-describedby="desc-insuf-naoinfo">
                                    <div class="bar-chart-fill" data-percentage="1.02" data-count="41">
                                        <span class="bar-chart-fill-text" aria-hidden="true">1.02%</span>
                                    </div>
                                </div>
                                <span id="desc-insuf-naoinfo" class="visually-hidden">41 museus, representando 1.02% do
                                    total</span>
                            </div>

                            <div class="bar-chart-item" role="listitem" tabindex="0">
                                <div class="bar-chart-header">
                                    <span class="bar-chart-label" id="label-insuf-particular">Particular</span>
                                </div>
                                <div class="bar-chart-track" role="img" aria-labelledby="label-insuf-particular"
                                    aria-describedby="desc-insuf-particular">
                                    <div class="bar-chart-fill" data-percentage="0.67" data-count="27">
                                        <span class="bar-chart-fill-text" aria-hidden="true">0.67%</span>
                                    </div>
                                </div>
                                <span id="desc-insuf-particular" class="visually-hidden">27 museus, representando 0.67%
                                    do total</span>
                            </div>
                        </div>
                    </div>
                </div>

            </section>

            <section class="article-section">
                <h2>Situação de funcionamento dos museus cadastrados</h2>
                <p class="filter-description">Distribuição de museus abertos (em funcionamento) e fechados (inoperantes)
                    de acordo com sua esfera administrativa.</p>
                <div class="status-grid" id="statusContainer" role="region"
                    aria-label="Status de funcionamento por esfera" aria-live="polite">

                </div>

                <div class="sparkline-table-container">
                    <h3>Situação de funcionamento dos museus por estado</h3>

                    <table class="sparkline-table" id="statusTableByState" tabindex="0">
                        <thead>
                            <tr>
                                <th scope="col" class="sortable" data-sort="estado" tabindex="-1" role="button"
                                    aria-label="Ordenar por estado">
                                    Estado
                                </th>
                                <th scope="col" class="sortable" data-sort="total" tabindex="-1" role="button"
                                    aria-label="Ordenar por total de museus">
                                    Total
                                </th>
                                <th scope="col" class="sortable" data-sort="abertos" tabindex="-1" role="button"
                                    aria-label="Ordenar por museus abertos">
                                    Abertos
                                </th>
                                <th scope="col" class="sortable" data-sort="fechados" tabindex="-1" role="button"
                                    aria-label="Ordenar por museus fechados">
                                    Fechados
                                </th>
                            </tr>
                        </thead>
                        <tbody id="statusTableBody">

                        </tbody>
                    </table>
                </div>

                <div class="show-more-container">
                    <button id="showMoreStatusButton" class="show-more-button" type="button">
                        Exibir todos os estados
                    </button>
                </div>
            </section>

            <section class="article-section">
                <h2>Temáticas dos Museus no Brasil</h2>
                <p class="filter-description">
                    Distribuição das temáticas informadas pelos 4.024 museus cadastrados no país, organizadas por esfera
                    administrativa.
                </p>

                <div id="tematicasAnnouncement" class="tematicas-announcement" role="status" aria-live="polite"
                    aria-atomic="true"></div>
                <div class="tematicas-table-container">
                    <table class="tematicas-table" id="tematicasTable" role="table" tabindex="0"
                        aria-label="Tabela de distribuição de temáticas por esfera administrativa. Pressione Enter ou Espaço para navegar pelas células. Pressione ESC para sair.">
                        <thead>
                            <tr>
                                <th class="col-tematica sortable" scope="col" data-sort="tematica" tabindex="-1"
                                    role="button" aria-label="Ordenar por temática">
                                    Temática
                                </th>
                                <th class="col-total sortable" scope="col" data-sort="total" tabindex="-1" role="button"
                                    aria-label="Ordenar por total de museus">
                                    Total
                                </th>
                                <th class="col-esfera sortable" scope="col" data-sort="publica" tabindex="-1"
                                    role="button" aria-label="Ordenar por museus públicos">
                                    Pública
                                </th>
                                <th class="col-esfera sortable" scope="col" data-sort="privada" tabindex="-1"
                                    role="button" aria-label="Ordenar por museus privados">
                                    Privada
                                </th>
                                <th class="col-esfera sortable" scope="col" data-sort="particular" tabindex="-1"
                                    role="button" aria-label="Ordenar por museus particulares">
                                    Particular
                                </th>
                                <th class="col-esfera sortable" scope="col" data-sort="mista" tabindex="-1"
                                    role="button" aria-label="Ordenar por museus de esfera mista">
                                    Mista
                                </th>
                                <th class="col-esfera sortable" scope="col" data-sort="nao-informado" tabindex="-1"
                                    role="button" aria-label="Ordenar por museus sem informação">
                                    Não informado
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tematicasTableBody">

                        </tbody>
                    </table>
                </div>
            </section>

            <section class="article-section">
                <h2>Visitas Guiadas nos Museus Brasileiros</h2>
                <p class="filter-description">
                    Distribuição dos 4.024 museus cadastrados de acordo com a oferta de visitas guiadas,
                    organizada por esfera administrativa.
                </p>

                <div class="visitas-cards-grid" role="region" aria-label="Resumo executivo de visitas guiadas">
                    <div class="visita-card" tabindex="0" role="article"
                        aria-label="Museus que não oferecem visitas guiadas: 1.347 museus, representando 33.5% do total">
                        <div class="visita-card-icon" aria-hidden="true">❌</div>
                        <div class="visita-card-title">Não oferece</div>
                        <div class="visita-card-number">1.347</div>
                        <div class="visita-card-percentage">33.5%</div>
                        <div class="visita-card-label">museus</div>
                    </div>

                    <div class="visita-card" tabindex="0" role="article"
                        aria-label="Museus que oferecem visitas guiadas: 1.189 museus, representando 29.5% do total">
                        <div class="visita-card-icon" aria-hidden="true">✅</div>
                        <div class="visita-card-title">Oferece visitas</div>
                        <div class="visita-card-number">1.189</div>
                        <div class="visita-card-percentage">29.5%</div>
                        <div class="visita-card-label">museus</div>
                    </div>

                    <div class="visita-card" tabindex="0" role="article"
                        aria-label="Museus com visitas somente mediante agendamento: 994 museus, representando 24.7% do total">
                        <div class="visita-card-icon" aria-hidden="true">📅</div>
                        <div class="visita-card-title">Só com agendamento</div>
                        <div class="visita-card-number">994</div>
                        <div class="visita-card-percentage">24.7%</div>
                        <div class="visita-card-label">museus</div>
                    </div>

                    <div class="visita-card" tabindex="0" role="article"
                        aria-label="Museus com visitas sem necessidade de agendamento: 482 museus, representando 12.0% do total">
                        <div class="visita-card-icon" aria-hidden="true">🚶</div>
                        <div class="visita-card-title">Sem agendamento</div>
                        <div class="visita-card-number">482</div>
                        <div class="visita-card-percentage">12.0%</div>
                        <div class="visita-card-label">museus</div>
                    </div>

                    <div class="visita-card" tabindex="0" role="article"
                        aria-label="Museus sem informações sobre visitas guiadas: 8 museus, representando 0.2% do total">
                        <div class="visita-card-icon" aria-hidden="true">❓</div>
                        <div class="visita-card-title">Sem informação</div>
                        <div class="visita-card-number">12</div>
                        <div class="visita-card-percentage">0.3%</div>
                        <div class="visita-card-label">museus</div>
                    </div>
                </div>

                <h3 style="text-align: center; color: var(--link); margin: 3rem 0 2rem; font-size: 1.25rem;">
                    Distribuição por Esfera Administrativa
                </h3>

                <div class="visitas-stacked-bars" role="region"
                    aria-label="Gráfico de barras empilhadas mostrando distribuição por esfera">
                    <div id="visitasStackedContainer">

                    </div>
                </div>
            </section>

            <section class="article-section">
                <h2>Cobrança de Entrada nos Museus Brasileiros</h2>
                <p class="filter-description">
                    Distribuição dos 4.024 museus cadastrados de acordo com a política de cobrança de entrada.
                </p>

                <div class="entrada-cards-wrapper" role="region"
                    aria-label="Política de cobrança de entrada nos museus">
                    <div id="entradaCardsContainer">

                    </div>
                </div>

                <div class="sparkline-table-container">
                    <h3>Cobrança de entrada por estado</h3>
                    <div id="sortAnnouncementEntrada" class="sort-announcement" role="status" aria-live="polite"
                        aria-atomic="true"></div>
                    <table class="sparkline-table" id="entradaTableByState" tabindex="0" role="table"
                        aria-label="Tabela de cobrança de entrada por estado. Pressione Enter ou Espaço para começar a navegar pelas células. Pressione ESC para sair.">
                        <thead>
                            <tr>
                                <th scope="col" class="sortable" data-sort="estado" tabindex="-1" role="button"
                                    aria-label="Ordenar por estado">
                                    Estado
                                </th>
                                <th scope="col" class="sortable" data-sort="total" tabindex="-1" role="button"
                                    aria-label="Ordenar por total de museus">
                                    Total
                                </th>
                                <th scope="col" class="sortable" data-sort="nao" tabindex="-1" role="button"
                                    aria-label="Ordenar por entrada gratuita">
                                    Entrada gratuita
                                </th>
                                <th scope="col" class="sortable" data-sort="contribuicao" tabindex="-1" role="button"
                                    aria-label="Ordenar por contribuição voluntária">
                                    Contribuição voluntária
                                </th>
                                <th scope="col" class="sortable" data-sort="sim" tabindex="-1" role="button"
                                    aria-label="Ordenar por entrada paga">
                                    Entrada paga
                                </th>
                                <th scope="col" class="sortable" data-sort="nao-informado" tabindex="-1" role="button"
                                    aria-label="Ordenar por não informado">
                                    Não informado
                                </th>
                                <th scope="col" class="sortable" data-sort="nao-disponivel" tabindex="-1" role="button"
                                    aria-label="Ordenar por não disponível">
                                    Não disponível
                                </th>
                            </tr>
                        </thead>
                        <tbody id="entradaTableBody">

                        </tbody>
                    </table>
                </div>

                <div class="show-more-container">
                    <button id="showMoreEntradaButton" class="show-more-button" type="button">
                        Exibir todos os estados
                    </button>
                </div>
            </section>

            <section class="article-section">
                <h2>Presença Digital dos Museus Brasileiros</h2>
                <p class="filter-description">Distribuição dos 4.024 museus cadastrados de acordo com sua presença em
                    plataformas digitais (site oficial e redes sociais).</p>
                <div class="digital-grid" id="digitalContainer" role="region"
                    aria-label="Presença digital por plataforma" aria-live="polite">

                </div>
            </section>

        </article>

        <section class="article-section note">
            <h3 class="guima-note-title">Fonte de dados utilizada</h3>
            <p>Os dados utilizados são autodeclarados pelos museus na plataforma oficial <a
                    href="https://cadastro.museus.gov.br/">MuseusBR</a>, criada pelo <a
                    href="https://www.gov.br/museus/pt-br">Instituto Brasileiro de Museus - Ibram</a>.
                A última coleta de dados foi realizada em setembro de 2025, e as informações podem ter sido atualizadas
                pelos museus posteriormente. Recomenda-se entrar em contato com o museu antes da visita.</p>
        </section>

        <a href="#main-nav" class="back-to-top" tabindex="0">Voltar ao menu de navegação do site</a>

    </main>

    <footer class="footer">
        <p class="footer-text">Projeto desenvolvido por <a href="https://www.linkedin.com/in/icaroferracini/" class="link-footer">Ícaro Ferracini</a> como trabalho de conclusão de curso para o MBA de Jornalismo de Dados - 2025</p>
    </footer>

    <script>
        // ========== Presença digital ==========
        const digitalData = [
            {
                title: 'Site Oficial',
                total: 4024,
                possui: { count: 2223, percentage: 55.24 },
                naoPossui: { count: 1801, percentage: 44.76 }
            },
            {
                title: 'Facebook',
                total: 4024,
                possui: { count: 708, percentage: 17.59 },
                naoPossui: { count: 3316, percentage: 82.41 }
            },
            {
                title: 'Instagram',
                total: 4024,
                possui: { count: 446, percentage: 11.08 },
                naoPossui: { count: 3578, percentage: 88.92 }
            },
            {
                title: 'YouTube',
                total: 4024,
                possui: { count: 143, percentage: 3.55 },
                naoPossui: { count: 3881, percentage: 96.45 }
            },
            {
                title: 'TikTok',
                total: 4024,
                possui: { count: 9, percentage: 0.22 },
                naoPossui: { count: 4015, percentage: 99.78 }
            },
            {
                title: 'Spotify',
                total: 4024,
                possui: { count: 6, percentage: 0.15 },
                naoPossui: { count: 4018, percentage: 99.85 }
            }
        ];

        function createDigitalItem(data) {
            const { title, total, possui, naoPossui } = data;

            const digitalItem = document.createElement('div');
            digitalItem.className = 'digital-item';
            digitalItem.setAttribute('role', 'article');
            digitalItem.setAttribute('tabindex', '0');
            digitalItem.setAttribute('aria-label', `${title}: ${total} museus no total. ${possui.count} possuem (${possui.percentage}%) e ${naoPossui.count} não possuem (${naoPossui.percentage}%)`);

            const titleDiv = document.createElement('div');
            titleDiv.className = 'digital-title';
            titleDiv.textContent = title;
            titleDiv.setAttribute('aria-hidden', 'true');

            const barContainer = document.createElement('div');
            barContainer.className = 'digital-bar-container';

            const stackedBar = document.createElement('div');
            stackedBar.className = 'digital-stacked-bar';
            stackedBar.setAttribute('role', 'img');
            stackedBar.setAttribute('aria-label', `Barra mostrando ${possui.count} possuem e ${naoPossui.count} não possuem`);

            const possuiSegment = document.createElement('div');
            possuiSegment.className = 'digital-bar-segment bar-possui';
            possuiSegment.style.width = '0%';
            possuiSegment.setAttribute('data-width', possui.percentage);
            const possuiText = document.createElement('span');
            possuiText.className = 'digital-bar-segment-text';
            possuiText.textContent = possui.percentage.toLocaleString('pt-BR') + '%';
            possuiSegment.appendChild(possuiText);

            const naoPossuiSegment = document.createElement('div');
            naoPossuiSegment.className = 'digital-bar-segment bar-nao-possui';
            naoPossuiSegment.style.width = '0%';
            naoPossuiSegment.setAttribute('data-width', naoPossui.percentage);
            const naoPossuiText = document.createElement('span');
            naoPossuiText.className = 'digital-bar-segment-text';
            naoPossuiText.textContent = naoPossui.percentage.toLocaleString('pt-BR') + '%';
            naoPossuiSegment.appendChild(naoPossuiText);

            stackedBar.appendChild(possuiSegment);
            stackedBar.appendChild(naoPossuiSegment);
            barContainer.appendChild(stackedBar);

            const detailsDiv = document.createElement('div');
            detailsDiv.className = 'digital-details';
            detailsDiv.setAttribute('aria-hidden', 'true');

            const possuiDetail = document.createElement('div');
            possuiDetail.className = 'digital-detail-item';
            possuiDetail.innerHTML = `
                <div class="digital-detail-label">
                <div class="digital-detail-color bar-possui"></div>
                <span>Possui</span>
                </div>
                <div class="digital-detail-value">${possui.count.toLocaleString('pt-BR')} <span>(${possui.percentage.toLocaleString('pt-BR')}%)</span></div>
                `;

            const naoPossuiDetail = document.createElement('div');
            naoPossuiDetail.className = 'digital-detail-item';
            naoPossuiDetail.innerHTML = `
                <div class="digital-detail-label">
                <div class="digital-detail-color bar-nao-possui"></div>
                <span>Não possui</span>
                </div>
                <div class="digital-detail-value">${naoPossui.count.toLocaleString('pt-BR')} <span>(${naoPossui.percentage.toLocaleString('pt-BR')}%)</span></div>
                `;

            detailsDiv.appendChild(possuiDetail);
            detailsDiv.appendChild(naoPossuiDetail);

            const totalLine = document.createElement('div');
            totalLine.className = 'digital-total-line';
            totalLine.innerHTML = `
                <div class="digital-total-label">Total de museus</div>
                <div class="digital-total-value">${total.toLocaleString('pt-BR')}</div>
                `;

            digitalItem.appendChild(titleDiv);
            digitalItem.appendChild(barContainer);
            digitalItem.appendChild(detailsDiv);

            return digitalItem;
        }

        function animateDigitalBars() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const segments = entry.target.querySelectorAll('.digital-bar-segment');
                        segments.forEach((segment, index) => {
                            setTimeout(() => {
                                const width = segment.getAttribute('data-width');
                                segment.style.width = width + '%';
                                setTimeout(() => {
                                    segment.classList.add('animated');
                                }, 150);
                            }, index * 100);
                        });
                        observer.unobserve(entry.target);
                    }
                });
            }, {
                threshold: 0.2
            });

            document.querySelectorAll('.digital-stacked-bar').forEach(bar => {
                observer.observe(bar);
            });
        }

        function renderDigitalGrid() {
            const container = document.getElementById('digitalContainer');
            container.innerHTML = '';

            digitalData.forEach(data => {
                const digitalItem = createDigitalItem(data);
                container.appendChild(digitalItem);
            });
            animateDigitalBars();
        }

        // ========== Cobrança de entrada ==========
        const entradaPorEstado = [
            { estado: 'SP', nomeCompleto: 'São Paulo', total: 698, nao: 595, percNao: 85.24, sim: 89, percSim: 12.75, contribuicao: 13, percContribuicao: 1.86, naoInformado: 1, percNaoInformado: 0.14, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'RS', nomeCompleto: 'Rio Grande do Sul', total: 496, nao: 438, percNao: 88.31, sim: 51, percSim: 10.28, contribuicao: 6, percContribuicao: 1.21, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 1, percNaoDisponivel: 0.2 },
            { estado: 'MG', nomeCompleto: 'Minas Gerais', total: 477, nao: 412, percNao: 86.37, sim: 57, percSim: 11.95, contribuicao: 7, percContribuicao: 1.47, naoInformado: 1, percNaoInformado: 0.21, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'RJ', nomeCompleto: 'Rio de Janeiro', total: 334, nao: 268, percNao: 80.24, sim: 61, percSim: 18.26, contribuicao: 5, percContribuicao: 1.5, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'PR', nomeCompleto: 'Paraná', total: 314, nao: 283, percNao: 90.13, sim: 27, percSim: 8.6, contribuicao: 3, percContribuicao: 0.96, naoInformado: 1, percNaoInformado: 0.32, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'SC', nomeCompleto: 'Santa Catarina', total: 254, nao: 207, percNao: 81.5, sim: 40, percSim: 15.75, contribuicao: 7, percContribuicao: 2.76, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'BA', nomeCompleto: 'Bahia', total: 191, nao: 145, percNao: 75.92, sim: 39, percSim: 20.42, contribuicao: 5, percContribuicao: 2.62, naoInformado: 1, percNaoInformado: 0.52, naoDisponivel: 1, percNaoDisponivel: 0.52 },
            { estado: 'CE', nomeCompleto: 'Ceará', total: 183, nao: 150, percNao: 81.97, sim: 19, percSim: 10.38, contribuicao: 14, percContribuicao: 7.65, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'PE', nomeCompleto: 'Pernambuco', total: 141, nao: 100, percNao: 70.92, sim: 35, percSim: 24.82, contribuicao: 6, percContribuicao: 4.26, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'PB', nomeCompleto: 'Paraíba', total: 101, nao: 88, percNao: 87.13, sim: 8, percSim: 7.92, contribuicao: 5, percContribuicao: 4.95, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'DF', nomeCompleto: 'Distrito Federal', total: 90, nao: 85, percNao: 94.44, sim: 4, percSim: 4.44, contribuicao: 0, percContribuicao: 0.0, naoInformado: 1, percNaoInformado: 1.11, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'RN', nomeCompleto: 'Rio Grande do Norte', total: 89, nao: 74, percNao: 83.15, sim: 11, percSim: 12.36, contribuicao: 4, percContribuicao: 4.49, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'ES', nomeCompleto: 'Espírito Santo', total: 84, nao: 73, percNao: 86.9, sim: 9, percSim: 10.71, contribuicao: 2, percContribuicao: 2.38, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'GO', nomeCompleto: 'Goiás', total: 83, nao: 69, percNao: 83.13, sim: 12, percSim: 14.46, contribuicao: 1, percContribuicao: 1.2, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 1, percNaoDisponivel: 1.2 },
            { estado: 'AL', nomeCompleto: 'Alagoas', total: 67, nao: 58, percNao: 86.57, sim: 9, percSim: 13.43, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'PA', nomeCompleto: 'Pará', total: 63, nao: 48, percNao: 76.19, sim: 14, percSim: 22.22, contribuicao: 1, percContribuicao: 1.59, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'MS', nomeCompleto: 'Mato Grosso do Sul', total: 60, nao: 56, percNao: 93.33, sim: 2, percSim: 3.33, contribuicao: 2, percContribuicao: 3.33, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'MT', nomeCompleto: 'Mato Grosso', total: 55, nao: 52, percNao: 94.55, sim: 2, percSim: 3.64, contribuicao: 1, percContribuicao: 1.82, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'MA', nomeCompleto: 'Maranhão', total: 54, nao: 48, percNao: 88.89, sim: 6, percSim: 11.11, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'AM', nomeCompleto: 'Amazonas', total: 48, nao: 39, percNao: 81.25, sim: 8, percSim: 16.67, contribuicao: 1, percContribuicao: 2.08, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'SE', nomeCompleto: 'Sergipe', total: 34, nao: 26, percNao: 76.47, sim: 8, percSim: 23.53, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'PI', nomeCompleto: 'Piauí', total: 33, nao: 23, percNao: 69.7, sim: 9, percSim: 27.27, contribuicao: 1, percContribuicao: 3.03, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'AC', nomeCompleto: 'Acre', total: 24, nao: 24, percNao: 100.0, sim: 0, percSim: 0.0, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'TO', nomeCompleto: 'Tocantins', total: 21, nao: 20, percNao: 95.24, sim: 1, percSim: 4.76, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'RO', nomeCompleto: 'Rondônia', total: 18, nao: 16, percNao: 88.89, sim: 2, percSim: 11.11, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'AP', nomeCompleto: 'Amapá', total: 9, nao: 9, percNao: 100.0, sim: 0, percSim: 0.0, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 },
            { estado: 'RR', nomeCompleto: 'Roraima', total: 3, nao: 3, percNao: 100.0, sim: 0, percSim: 0.0, contribuicao: 0, percContribuicao: 0.0, naoInformado: 0, percNaoInformado: 0.0, naoDisponivel: 0, percNaoDisponivel: 0.0 }
        ];

        let currentSortColumnEntrada = 'nao';
        let currentSortOrderEntrada = 'desc';

        function createEntradaRow(data) {
            const row = document.createElement('tr');

            const estadoCell = document.createElement('td');
            estadoCell.className = 'estado-name';
            estadoCell.setAttribute('scope', 'row');
            estadoCell.setAttribute('data-label', 'Estado:');
            estadoCell.setAttribute('tabindex', '-1');
            estadoCell.setAttribute('aria-label', `Estado: ${data.nomeCompleto}`);
            const estadoText = document.createElement('span');
            estadoText.setAttribute('aria-hidden', 'true');
            estadoText.textContent = data.nomeCompleto;
            estadoCell.appendChild(estadoText);

            const totalCell = document.createElement('td');
            totalCell.className = 'total-museus';
            totalCell.setAttribute('data-label', 'Total:');
            totalCell.setAttribute('tabindex', '-1');
            totalCell.setAttribute('aria-label', `${data.total} ${data.total === 1 ? 'museu' : 'museus'} no total`);
            const totalText = document.createElement('span');
            totalText.setAttribute('aria-hidden', 'true');
            totalText.textContent = data.total.toLocaleString('pt-BR');
            totalCell.appendChild(totalText);

            const naoCell = document.createElement('td');
            naoCell.className = 'sparkline-cell';
            naoCell.setAttribute('data-label', 'Entrada gratuita:');
            naoCell.setAttribute('tabindex', '-1');
            const naoLabel = data.nao === 0
                ? 'Nenhum museu com entrada gratuita'
                : `${data.nao} ${data.nao === 1 ? 'museu' : 'museus'} com entrada gratuita, correspondendo a ${data.percNao.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 2 })}%`;
            naoCell.setAttribute('aria-label', naoLabel);
            const naoContainer = document.createElement('div');
            naoContainer.className = 'category-container';
            naoContainer.setAttribute('aria-hidden', 'true');
            naoContainer.appendChild(createMiniBar(data.percNao, data.nao, 'nao-cobra', 'Gratuita'));
            naoCell.appendChild(naoContainer);

            const contribCell = document.createElement('td');
            contribCell.className = 'sparkline-cell';
            contribCell.setAttribute('data-label', 'Contribuição voluntária:');
            contribCell.setAttribute('tabindex', '-1');
            const contribLabel = data.contribuicao === 0
                ? 'Nenhum museu com contribuição voluntária'
                : `${data.contribuicao} ${data.contribuicao === 1 ? 'museu' : 'museus'} com contribuição voluntária, correspondendo a ${data.percContribuicao.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 2 })}%`;
            contribCell.setAttribute('aria-label', contribLabel);
            const contribContainer = document.createElement('div');
            contribContainer.className = 'category-container';
            contribContainer.setAttribute('aria-hidden', 'true');
            contribContainer.appendChild(createMiniBar(data.percContribuicao, data.contribuicao, 'contribuicao', 'Contribuição'));
            contribCell.appendChild(contribContainer);

            const simCell = document.createElement('td');
            simCell.className = 'sparkline-cell';
            simCell.setAttribute('data-label', 'Entrada paga:');
            simCell.setAttribute('tabindex', '-1');
            const simLabel = data.sim === 0
                ? 'Nenhum museu com entrada paga'
                : `${data.sim} ${data.sim === 1 ? 'museu' : 'museus'} com entrada paga, correspondendo a ${data.percSim.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 2 })}%`;
            simCell.setAttribute('aria-label', simLabel);
            const simContainer = document.createElement('div');
            simContainer.className = 'category-container';
            simContainer.setAttribute('aria-hidden', 'true');
            simContainer.appendChild(createMiniBar(data.percSim, data.sim, 'cobra', 'Paga'));
            simCell.appendChild(simContainer);

            const naoInfCell = document.createElement('td');
            naoInfCell.className = 'sparkline-cell';
            naoInfCell.setAttribute('data-label', 'Não informado:');
            naoInfCell.setAttribute('tabindex', '-1');
            const naoInfLabel = data.naoInformado === 0
                ? 'Nenhum museu sem informação'
                : `${data.naoInformado} ${data.naoInformado === 1 ? 'museu' : 'museus'} sem informação, correspondendo a ${data.percNaoInformado.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 2 })}%`;
            naoInfCell.setAttribute('aria-label', naoInfLabel);
            const naoInfContainer = document.createElement('div');
            naoInfContainer.className = 'category-container';
            naoInfContainer.setAttribute('aria-hidden', 'true');
            naoInfContainer.appendChild(createMiniBar(data.percNaoInformado, data.naoInformado, 'nao-informado', 'Não informado'));
            naoInfCell.appendChild(naoInfContainer);

            const naoDispCell = document.createElement('td');
            naoDispCell.className = 'sparkline-cell';
            naoDispCell.setAttribute('data-label', 'Não disponível:');
            naoDispCell.setAttribute('tabindex', '-1');
            const naoDispLabel = data.naoDisponivel === 0
                ? 'Nenhum museu com informação não disponível'
                : `${data.naoDisponivel} ${data.naoDisponivel === 1 ? 'museu' : 'museus'} com informação não disponível, correspondendo a ${data.percNaoDisponivel.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 2 })}%`;
            naoDispCell.setAttribute('aria-label', naoDispLabel);
            const naoDispContainer = document.createElement('div');
            naoDispContainer.className = 'category-container';
            naoDispContainer.setAttribute('aria-hidden', 'true');
            naoDispContainer.appendChild(createMiniBar(data.percNaoDisponivel, data.naoDisponivel, 'nao-disponivel', 'Não disponível'));
            naoDispCell.appendChild(naoDispContainer);

            row.appendChild(estadoCell);
            row.appendChild(totalCell);
            row.appendChild(naoCell);
            row.appendChild(contribCell);
            row.appendChild(simCell);
            row.appendChild(naoInfCell);
            row.appendChild(naoDispCell);

            return row;
        }

        function renderEntradaTable(data = entradaPorEstado, showAll = false) {
            const tbody = document.getElementById('entradaTableBody');
            tbody.innerHTML = '';

            data.forEach((estado, index) => {
                const row = createEntradaRow(estado);

                if (index >= 5 && !showAll) {
                    row.classList.add('hidden-row');
                }

                tbody.appendChild(row);
            });

            updateShowMoreEntradaButton(data.length, showAll);
        }

        function updateShowMoreEntradaButton(totalRows, showAll) {
            const button = document.getElementById('showMoreEntradaButton');
            const container = button.parentElement;

            if (totalRows <= 5) {
                container.style.display = 'none';
            } else {
                container.style.display = 'block';
                if (showAll) {
                    button.textContent = 'Exibir apenas primeiros 5';
                    button.setAttribute('aria-label', 'Recolher tabela para mostrar apenas os 5 primeiros estados');
                } else {
                    button.textContent = `Exibir todos os ${totalRows} estados`;
                    button.setAttribute('aria-label', `Expandir tabela para mostrar todos os ${totalRows} estados`);
                }
            }
        }

        function toggleShowAllEntrada() {
            const hiddenRows = document.querySelectorAll('#entradaTableBody .hidden-row');
            const isCurrentlyHidden = hiddenRows.length > 0;

            if (isCurrentlyHidden) {
                hiddenRows.forEach(row => row.classList.remove('hidden-row'));
                updateShowMoreEntradaButton(entradaPorEstado.length, true);
            } else {
                const allRows = document.querySelectorAll('#entradaTableBody tr');
                allRows.forEach((row, index) => {
                    if (index >= 5) {
                        row.classList.add('hidden-row');
                    }
                });
                updateShowMoreEntradaButton(entradaPorEstado.length, false);
            }
        }

        function sortEntradaTable(column) {
            const announcement = document.getElementById('sortAnnouncementEntrada');

            if (currentSortColumnEntrada === column) {
                currentSortOrderEntrada = currentSortOrderEntrada === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumnEntrada = column;
                currentSortOrderEntrada = column === 'estado' ? 'asc' : 'desc';
            }

            const sortedData = [...entradaPorEstado].sort((a, b) => {
                let comparison = 0;

                if (column === 'estado') {
                    comparison = a.estado.localeCompare(b.estado);
                } else if (column === 'total') {
                    comparison = a.total - b.total;
                } else if (column === 'nao') {
                    comparison = a.percNao - b.percNao;
                } else if (column === 'sim') {
                    comparison = a.percSim - b.percSim;
                } else if (column === 'contribuicao') {
                    comparison = a.percContribuicao - b.percContribuicao;
                } else if (column === 'nao-informado') {
                    comparison = a.percNaoInformado - b.percNaoInformado;
                } else if (column === 'nao-disponivel') {
                    comparison = a.percNaoDisponivel - b.percNaoDisponivel;
                }

                return currentSortOrderEntrada === 'asc' ? comparison : -comparison;
            });

            document.querySelectorAll('#entradaTableByState th').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
                if (th.dataset.sort === column) {
                    th.classList.add(`sorted-${currentSortOrderEntrada}`);
                }
            });

            renderEntradaTable(sortedData);

            const orderText = currentSortOrderEntrada === 'asc' ? 'crescente' : 'decrescente';
            const columnNames = {
                'estado': 'estado',
                'total': 'total de museus',
                'nao': 'entrada gratuita',
                'sim': 'entrada paga',
                'contribuicao': 'contribuição voluntária',
                'nao-informado': 'não informado',
                'nao-disponivel': 'não disponível'
            };
            announcement.textContent = `Tabela ordenada por ${columnNames[column]} em ordem ${orderText}`;
        }

        function initEntradaSort() {
            document.querySelectorAll('#entradaTableByState th.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    sortEntradaTable(th.dataset.sort);
                });

                th.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        sortEntradaTable(th.dataset.sort);
                    }
                });
            });
        }

        function initEntradaSort() {
            document.querySelectorAll('#entradaTableByState th.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    sortEntradaTable(th.dataset.sort);
                });

                th.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        sortEntradaTable(th.dataset.sort);
                    }
                });
            });
        }


        // ========== Acessibilidade ==========
        const entradaTable = document.getElementById('entradaTableByState');
        entradaTable.setAttribute('role', 'table');
        entradaTable.setAttribute('aria-label', 'Tabela de cobrança de entrada por estado. Pressione Enter ou Espaço para começar a navegar pelas células. Pressione ESC para sair.');

        let entradaTableActive = false;
        let previousFocusElementEntrada = null;

        entradaTable.addEventListener('keydown', (event) => {
            const allCells = Array.from(entradaTable.querySelectorAll('td'));
            const focusableCells = allCells.filter(td => td.getAttribute('tabindex') === '0');
            const currentIndex = focusableCells.indexOf(document.activeElement);

            if ((event.key === 'Enter' || event.key === ' ') && !entradaTableActive) {
                event.preventDefault();
                entradaTableActive = true;
                previousFocusElementEntrada = document.activeElement;

                allCells.forEach(td => td.setAttribute('tabindex', '0'));
                focusableCells[0].focus();

                const announcement = document.getElementById('sortAnnouncementEntrada');
                announcement.textContent = 'Modo de navegação na tabela ativado. Use Tab ou Shift+Tab para percorrer as células. Pressione ESC para sair.';
            }

            if (event.key === 'Escape' && entradaTableActive) {
                event.preventDefault();
                entradaTableActive = false;

                allCells.forEach(td => td.setAttribute('tabindex', '-1'));

                if (previousFocusElementEntrada) previousFocusElementEntrada.focus();
                const announcement = document.getElementById('sortAnnouncementEntrada');
                announcement.textContent = 'Saiu da tabela. Foco retornado ao elemento anterior.';
            }
        });

        // ========== Foco após expandir a tabela ==========
        document.getElementById('showMoreEntradaButton').addEventListener('click', () => {
            toggleShowAllEntrada();
            setTimeout(() => {
                const table = document.getElementById('entradaTableByState');
                if (table) {
                    table.focus();

                    // Atualiza mensagem para leitores de tela
                    const announcement = document.getElementById('sortAnnouncementEntrada');
                    announcement.textContent = 'Tabela expandida. Agora todos os 27 estados estão visíveis. Pressione Enter ou Espaço para começar a navegar pelas células.';
                }
            }, 200);
        });

        const sortedEntradaData = [...entradaPorEstado].sort((a, b) => b.percNao - a.percNao);
        renderEntradaTable(sortedEntradaData, false);

        currentSortColumnEntrada = 'nao';
        currentSortOrderEntrada = 'desc';

        document.querySelector('#entradaTableByState th[data-sort="nao"]').classList.add('sorted-desc');

        initEntradaSort();

        document.addEventListener('DOMContentLoaded', () => {
            const entradaData = [
                {
                    titulo: 'Entrada Gratuita',
                    total: 3409,
                    percentage: 84.72,
                    esferas: [
                        { nome: 'Pública', count: 2395, perc: 70.26, color: 'esfera-publica' },
                        { nome: 'Privada', count: 853, perc: 25.02, color: 'esfera-privada' },
                        { nome: 'Particular', count: 90, perc: 2.64, color: 'esfera-particular' },
                        { nome: 'Mista', count: 18, perc: 0.53, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 53, perc: 1.55, color: 'esfera-nao-informado' }
                    ]
                },
                {
                    titulo: 'Entrada Paga',
                    total: 523,
                    percentage: 13.0,
                    esferas: [
                        { nome: 'Privada', count: 277, perc: 52.96, color: 'esfera-privada' },
                        { nome: 'Pública', count: 198, perc: 37.86, color: 'esfera-publica' },
                        { nome: 'Particular', count: 37, perc: 7.07, color: 'esfera-particular' },
                        { nome: 'Mista', count: 3, perc: 0.57, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 8, perc: 1.53, color: 'esfera-nao-informado' }

                    ]
                },
                {
                    titulo: 'Contribuição Voluntária',
                    total: 84,
                    percentage: 2.09,
                    esferas: [
                        { nome: 'Privada', count: 51, perc: 60.71, color: 'esfera-privada' },
                        { nome: 'Pública', count: 18, perc: 21.43, color: 'esfera-publica' },
                        { nome: 'Particular', count: 13, perc: 15.48, color: 'esfera-particular' },
                        { nome: 'Mista', count: 2, perc: 2.38, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 0, perc: 0.0, color: 'esfera-nao-informado' }
                    ]
                },
                {
                    titulo: 'Não Informado',
                    total: 5,
                    percentage: 0.12,
                    esferas: [
                        { nome: 'Pública', count: 3, perc: 60.0, color: 'esfera-publica' },
                        { nome: 'Privada', count: 2, perc: 40.0, color: 'esfera-privada' }
                    ]
                },
                {
                    titulo: 'Não Disponível',
                    total: 3,
                    percentage: 0.07,
                    esferas: [
                        { nome: 'Pública', count: 2, perc: 66.67, color: 'esfera-publica' },
                        { nome: 'Particular', count: 1, perc: 33.33, color: 'esfera-particular' }
                    ]
                }
            ];

            function renderEntradaCards() {
                const container = document.getElementById('entradaCardsContainer');

                const gridContainer = document.createElement('div');
                gridContainer.className = 'entrada-cards-container';

                entradaData.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'entrada-card';
                    card.setAttribute('role', 'article');
                    card.setAttribute('tabindex', '0');

                    let ariaLabel = `${item.titulo}: ${item.percentage}% do total, equivalente a ${item.total} museus. `;
                    ariaLabel += 'Distribuição por esfera: ';
                    item.esferas.forEach((esfera, idx) => {
                        ariaLabel += `${esfera.nome}: ${esfera.count} museus (${esfera.perc.toFixed(2)}%)`;
                        if (idx < item.esferas.length - 1) ariaLabel += ', ';
                    });
                    card.setAttribute('aria-label', ariaLabel);

                    const header = document.createElement('div');
                    header.className = 'entrada-card-header';
                    header.setAttribute('aria-hidden', 'true');
                    header.innerHTML = `
                <div class="entrada-card-title">${item.titulo}</div>
                <div class="entrada-card-percentage">${item.percentage.toFixed(2)}%</div>
                <div class="entrada-card-total">${item.total.toLocaleString('pt-BR')}<span class="entrada-card-total-label"> museus</span></div>
                
            `;

                    const chart = document.createElement('div');
                    chart.className = 'entrada-card-chart';
                    chart.setAttribute('aria-hidden', 'true');

                    item.esferas.forEach(esfera => {
                        const chartItem = document.createElement('div');
                        chartItem.className = 'entrada-chart-item';

                        const label = document.createElement('div');
                        label.className = 'entrada-chart-label';
                        label.innerHTML = `
                            <span class="entrada-chart-esfera">${esfera.nome}</span>
                        `;

                        const barContainer = document.createElement('div');
                        barContainer.className = 'entrada-chart-bar-container';

                        const bar = document.createElement('div');
                        bar.className = `entrada-chart-bar ${esfera.color}`;
                        bar.style.setProperty('--bar-width', `${esfera.perc}%`);

                        const barText = document.createElement('span');
                        barText.className = 'entrada-chart-bar-text';
                        barText.textContent = `${esfera.count.toLocaleString('pt-BR')} (${esfera.perc.toFixed(2)}%)`;
                        bar.appendChild(barText);

                        barContainer.appendChild(bar);
                        chartItem.appendChild(label);
                        chartItem.appendChild(barContainer);
                        chart.appendChild(chartItem);
                    });

                    card.appendChild(header);
                    card.appendChild(chart);
                    gridContainer.appendChild(card);
                });

                container.appendChild(gridContainer);

                animateEntradaBars();
            }

            function animateEntradaBars() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const bars = entry.target.querySelectorAll('.entrada-chart-bar');
                            bars.forEach((bar, index) => {
                                setTimeout(() => {
                                    bar.classList.add('animated');
                                }, index * 100);
                            });
                            observer.unobserve(entry.target);
                        }
                    });
                }, {
                    threshold: 0.2
                });

                document.querySelectorAll('.entrada-card').forEach(card => {
                    observer.observe(card);
                });
            }

            renderEntradaCards();
        });

        // ========== Visitas guiadas ==========
        document.addEventListener('DOMContentLoaded', () => {
            const visitasData = [
                {
                    label: '❌ Não oferece visitas guiadas',
                    total: 1347,
                    percentage: 33.5,
                    esferas: [
                        { nome: 'Pública', count: 839, perc: 62.29, color: 'esfera-publica' },
                        { nome: 'Privada', count: 407, perc: 30.22, color: 'esfera-privada' },
                        { nome: 'Particular', count: 50, perc: 3.71, color: 'esfera-particular' },
                        { nome: 'Mista', count: 3, perc: 0.22, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 48, perc: 3.56, color: 'esfera-nao-informado' }
                    ]
                },
                {
                    label: '✅ Oferece visitas guiadas',
                    total: 1189,
                    percentage: 29.5,
                    esferas: [
                        { nome: 'Pública', count: 740, perc: 62.24, color: 'esfera-publica' },
                        { nome: 'Privada', count: 412, perc: 34.65, color: 'esfera-privada' },
                        { nome: 'Particular', count: 23, perc: 1.93, color: 'esfera-particular' },
                        { nome: 'Mista', count: 4, perc: 0.34, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 10, perc: 0.84, color: 'esfera-nao-informado' }

                    ]
                },
                {
                    label: '📅 Visitas somente mediante agendamento',
                    total: 994,
                    percentage: 24.7,
                    esferas: [
                        { nome: 'Pública', count: 680, perc: 68.41, color: 'esfera-publica' },
                        { nome: 'Privada', count: 256, perc: 25.75, color: 'esfera-privada' },
                        { nome: 'Particular', count: 47, perc: 4.73, color: 'esfera-particular' },
                        { nome: 'Mista', count: 9, perc: 0.91, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 2, perc: 0.2, color: 'esfera-nao-informado' }
                    ]
                },
                {
                    label: '🚶 Visitas sem necessidade de agendamento',
                    total: 482,
                    percentage: 12.0,
                    esferas: [
                        { nome: 'Pública', count: 348, perc: 72.2, color: 'esfera-publica' },
                        { nome: 'Privada', count: 105, perc: 21.78, color: 'esfera-privada' },
                        { nome: 'Particular', count: 21, perc: 4.36, color: 'esfera-particular' },
                        { nome: 'Mista', count: 7, perc: 1.45, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 1, perc: 0.21, color: 'esfera-nao-informado' }
                    ]
                },
                {
                    label: '❓ Não informado',
                    total: 12,
                    percentage: 0.3,
                    esferas: [
                        { nome: 'Pública', count: 9, perc: 75.0, color: 'esfera-publica' },
                        { nome: 'Privada', count: 3, perc: 25.0, color: 'esfera-privada' },
                        { nome: 'Particular', count: 0, perc: 0.0, color: 'esfera-particular' },
                        { nome: 'Mista', count: 0, perc: 0.0, color: 'esfera-mista' },
                        { nome: 'Não informado', count: 0, perc: 0.0, color: 'esfera-nao-informado' }
                    ]
                }
            ];

            function renderVisitasStacked() {
                const container = document.getElementById('visitasStackedContainer');

                visitasData.forEach(item => {
                    const barItem = document.createElement('div');
                    barItem.className = 'visita-bar-item';
                    barItem.setAttribute('role', 'article');
                    barItem.setAttribute('tabindex', '0');

                    // Cria descrição para leitores de tela
                    let ariaLabel = `${item.label}: ${item.total} museus (${item.percentage}% do total). Distribuição: `;
                    item.esferas.forEach((esfera, idx) => {
                        ariaLabel += `${esfera.nome}: ${esfera.count} museus (${esfera.perc.toFixed(2)}%)`;
                        if (idx < item.esferas.length - 1) ariaLabel += ', ';
                    });
                    barItem.setAttribute('aria-label', ariaLabel);

                    // Header
                    const header = document.createElement('div');
                    header.className = 'visita-bar-header';
                    header.innerHTML = `
                        <div class="visita-bar-label">${item.label}</div>
                        <div class="visita-bar-total">${item.total.toLocaleString('pt-BR')} museus (${item.percentage}%)</div>
                    `;

                    const stackedBar = document.createElement('div');
                    stackedBar.className = 'visita-stacked-bar';
                    stackedBar.setAttribute('role', 'img');
                    stackedBar.setAttribute('aria-hidden', 'true');

                    item.esferas.forEach(esfera => {
                        if (esfera.count === 0) return;

                        const segment = document.createElement('div');
                        segment.className = `visita-bar-segment ${esfera.color}`;
                        segment.style.width = '0%';
                        segment.setAttribute('data-width', esfera.perc);
                        segment.setAttribute('data-percentage', esfera.perc);
                        segment.setAttribute('data-small', esfera.perc < 8 ? 'true' : 'false');

                        const text = document.createElement('span');
                        text.className = 'visita-bar-segment-text';

                        if (esfera.perc >= 8) {
                            text.textContent = `${esfera.nome}: ${esfera.perc.toFixed(1)}%`;
                        }

                        segment.appendChild(text);
                        stackedBar.appendChild(segment);
                    });

                    const details = document.createElement('div');
                    details.className = 'visita-bar-details';
                    details.setAttribute('aria-hidden', 'true');

                    item.esferas.forEach(esfera => {
                        if (esfera.count === 0) return;

                        const detailItem = document.createElement('div');
                        detailItem.className = 'visita-detail-item';
                        detailItem.innerHTML = `
                            <div class="visita-detail-color ${esfera.color}"></div>
                            <div class="visita-detail-esfera">${esfera.nome}</div>
                            <div class="visita-detail-count">${esfera.count.toLocaleString('pt-BR')}</div>
                            <div class="visita-detail-perc">(${esfera.perc.toFixed(2)}%)</div>
                        `;
                        details.appendChild(detailItem);
                    });

                    barItem.appendChild(header);
                    barItem.appendChild(stackedBar);
                    barItem.appendChild(details);
                    container.appendChild(barItem);
                });

                animateVisitasBars();
            }

            function animateVisitasBars() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const segments = entry.target.querySelectorAll('.visita-bar-segment');
                            segments.forEach((segment, index) => {
                                setTimeout(() => {
                                    const width = segment.getAttribute('data-width');
                                    segment.style.width = width + '%';
                                    setTimeout(() => {
                                        segment.classList.add('animated');
                                    }, 150);
                                }, index * 100);
                            });
                            observer.unobserve(entry.target);
                        }
                    });
                }, {
                    threshold: 0.2
                });

                document.querySelectorAll('.visita-stacked-bar').forEach(bar => {
                    observer.observe(bar);
                });
            }

            renderVisitasStacked();
        });

        // ========== Temática ==========
        document.addEventListener('DOMContentLoaded', () => {
            const tematicasData = [
                {
                    label: 'História',
                    total: 1890,
                    value: 46.97,
                    color: '#004aad',
                    publica: { count: 1249, perc: 66.08 },
                    privada: { count: 532, perc: 28.15 },
                    particular: { count: 82, perc: 4.34 },
                    mista: { count: 13, perc: 0.69 },
                    naoInformado: { count: 14, perc: 0.74 }
                },
                {
                    label: 'Não informado',
                    total: 680,
                    value: 16.9,
                    color: '#636e72',
                    publica: { count: 417, perc: 61.23 },
                    privada: { count: 224, perc: 32.94 },
                    particular: { count: 2, perc: 0.29 },
                    mista: { count: 0, perc: 0.0 },
                    naoInformado: { count: 38, perc: 5.59 }
                },
                {
                    label: 'Artes, arquitetura e linguística',
                    total: 527,
                    value: 13.1,
                    color: '#ff8c00',
                    publica: { count: 310, perc: 58.82 },
                    privada: { count: 181, perc: 34.35 },
                    particular: { count: 24, perc: 4.55 },
                    mista: { count: 7, perc: 1.33 },
                    naoInformado: { count: 5, perc: 0.95 }
                },
                {
                    label: 'Ciências exatas, da terra, biológicas e da saúde',
                    total: 475,
                    value: 11.8,
                    color: '#0096c7',
                    publica: { count: 376, perc: 79.16 },
                    privada: { count: 83, perc: 17.47 },
                    particular: { count: 13, perc: 2.74 },
                    mista: { count: 1, perc: 0.21 },
                    naoInformado: { count: 2, perc: 0.42 }
                },
                {
                    label: 'Antropologia e arqueologia',
                    total: 237,
                    value: 5.89,
                    color: '#48cae4',
                    publica: { count: 146, perc: 61.6 },
                    privada: { count: 83, perc: 35.02 },
                    particular: { count: 6, perc: 2.53 },
                    mista: { count: 1, perc: 0.42 },
                    naoInformado: { count: 1, perc: 0.42 }
                },
                {
                    label: 'Educação, esporte e lazer',
                    total: 88,
                    value: 2.19,
                    color: '#2a9d8f',
                    publica: { count: 40, perc: 45.45 },
                    privada: { count: 43, perc: 48.86 },
                    particular: { count: 4, perc: 4.55 },
                    mista: { count: 1, perc: 1.14 },
                    naoInformado: { count: 0, perc: 0.0 }
                },
                {
                    label: 'Meios de comunicação e transporte',
                    total: 72,
                    value: 1.79,
                    color: '#d62828',
                    publica: { count: 44, perc: 61.11 },
                    privada: { count: 19, perc: 26.39 },
                    particular: { count: 8, perc: 11.11 },
                    mista: { count: 0, perc: 0.0 },
                    naoInformado: { count: 1, perc: 1.39 }
                },
                {
                    label: 'Defesa e segurança pública',
                    total: 29,
                    value: 0.72,
                    color: '#9d0208',
                    publica: { count: 28, perc: 96.55 },
                    privada: { count: 1, perc: 3.45 },
                    particular: { count: 0, perc: 0.0 },
                    mista: { count: 0, perc: 0.0 },
                    naoInformado: { count: 0, perc: 0.0 }
                },
                {
                    label: 'Produção de bens e serviços',
                    total: 25,
                    value: 0.62,
                    color: '#e85d04',
                    publica: { count: 6, perc: 24.0 },
                    privada: { count: 17, perc: 68.0 },
                    particular: { count: 2, perc: 8.0 },
                    mista: { count: 0, perc: 0.0 },
                    naoInformado: { count: 0, perc: 0.0 }
                }
            ];

            const totaisEsfera = {
                total: 4024,
                publica: { count: 2616, perc: 65.01 },
                privada: { count: 1183, perc: 29.4 },
                particular: { count: 141, perc: 3.5 },
                mista: { count: 23, perc: 0.57 },
                naoInformado: { count: 61, perc: 1.52 }
            };

            let currentSortColumn = 'total';
            let currentSortOrder = 'desc';

            function renderTable() {
                const tbody = document.getElementById('tematicasTableBody');
                tbody.innerHTML = '';

                tematicasData.forEach(item => {
                    const row = document.createElement('tr');

                    const percTotal = ((item.total / totaisEsfera.total) * 100).toFixed(2);

                    const isSmallBar = parseFloat(percTotal) < 50;

                    row.innerHTML = `
                        <td class="col-tematica" tabindex="-1" scope="row" 
                            aria-label="Temática: ${item.label}. ${percTotal}% do total, equivalente a ${item.total} museus">
                            <div class="tematica-cell">
                                <div class="tematica-header">
                                    <span class="tematica-label" aria-hidden="true">${item.label}</span>
                                </div>
                                <div class="tematica-bar-container" role="img" aria-hidden="true">
                                    <div class="tematica-bar-fill" style="--bar-width: ${percTotal}%; background-color: ${item.color}" data-small="${isSmallBar}">
                                        <span class="tematica-bar-text">${percTotal}% (${item.total.toLocaleString('pt-BR')})</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td class="col-total" data-label="Total" tabindex="-1"
                            aria-label="Total: ${item.total.toLocaleString('pt-BR')} museus, representando ${percTotal}% do total geral">
                            <div class="total-cell" aria-hidden="true">
                                <span class="total-count">${item.total.toLocaleString('pt-BR')}</span>
                                <span class="total-percentage">(${percTotal}%)</span>
                            </div>
                        </td>
                        <td class="col-esfera esfera-publica" data-label="Pública" tabindex="-1"
                            aria-label="Esfera pública: ${item.publica.count.toLocaleString('pt-BR')} museus, ${item.publica.perc.toFixed(2)}% desta temática">
                            <div class="esfera-cell" aria-hidden="true">
                                <span class="esfera-count">${item.publica.count.toLocaleString('pt-BR')}</span>
                                <span class="esfera-percentage">(${item.publica.perc.toFixed(2)}%)</span>
                            </div>
                        </td>
                        <td class="col-esfera esfera-privada" data-label="Privada" tabindex="-1"
                            aria-label="Esfera privada: ${item.privada.count.toLocaleString('pt-BR')} museus, ${item.privada.perc.toFixed(2)}% desta temática">
                            <div class="esfera-cell" aria-hidden="true">
                                <span class="esfera-count">${item.privada.count.toLocaleString('pt-BR')}</span>
                                <span class="esfera-percentage">(${item.privada.perc.toFixed(2)}%)</span>
                            </div>
                        </td>
                        <td class="col-esfera esfera-particular" data-label="Particular" tabindex="-1"
                            aria-label="Museus particulares: ${item.particular.count.toLocaleString('pt-BR')} museus, ${item.particular.perc.toFixed(2)}% desta temática">
                            <div class="esfera-cell" aria-hidden="true">
                                <span class="esfera-count">${item.particular.count.toLocaleString('pt-BR')}</span>
                                <span class="esfera-percentage">(${item.particular.perc.toFixed(2)}%)</span>
                            </div>
                        </td>
                        <td class="col-esfera esfera-mista" data-label="Mista" tabindex="-1"
                            aria-label="Esfera mista: ${item.mista.count.toLocaleString('pt-BR')} museus, ${item.mista.perc.toFixed(2)}% desta temática">
                            <div class="esfera-cell" aria-hidden="true">
                                <span class="esfera-count">${item.mista.count.toLocaleString('pt-BR')}</span>
                                <span class="esfera-percentage">(${item.mista.perc.toFixed(2)}%)</span>
                            </div>
                        </td>
                        <td class="col-esfera esfera-nao-informado" data-label="Não informado" tabindex="-1"
                            aria-label="Sem informação: ${item.naoInformado.count.toLocaleString('pt-BR')} museus, ${item.naoInformado.perc.toFixed(2)}% desta temática">
                            <div class="esfera-cell" aria-hidden="true">
                                <span class="esfera-count">${item.naoInformado.count.toLocaleString('pt-BR')}</span>
                                <span class="esfera-percentage">(${item.naoInformado.perc.toFixed(2)}%)</span>
                            </div>
                        </td>
                    `;

                    tbody.appendChild(row);
                });

                const totalRow = document.createElement('tr');
                totalRow.className = 'total-row';
                totalRow.innerHTML = `
                    <td class="col-tematica" tabindex="-1" scope="row" aria-label="Total geral de todas as temáticas">
                        <div class="tematica-cell">
                            <div class="tematica-header">
                                <span class="tematica-label" aria-hidden="true">TOTAL GERAL</span>
                            </div>
                        </div>
                    </td>
                    <td class="col-total" data-label="Total" tabindex="-1"
                        aria-label="Total geral: ${totaisEsfera.total.toLocaleString('pt-BR')} museus, 100% do total">
                        <div class="total-cell" aria-hidden="true">
                            <span class="total-count">${totaisEsfera.total.toLocaleString('pt-BR')}</span>
                            <span class="total-percentage">(100%)</span>
                        </div>
                    </td>
                    <td class="col-esfera esfera-publica" data-label="Pública" tabindex="-1"
                        aria-label="Total esfera pública: ${totaisEsfera.publica.count.toLocaleString('pt-BR')} museus, ${totaisEsfera.publica.perc.toFixed(2)}% do total geral">
                        <div class="esfera-cell" aria-hidden="true">
                            <span class="esfera-count">${totaisEsfera.publica.count.toLocaleString('pt-BR')}</span>
                            <span class="esfera-percentage">(${totaisEsfera.publica.perc.toFixed(2)}%)</span>
                        </div>
                    </td>
                    <td class="col-esfera esfera-privada" data-label="Privada" tabindex="-1"
                        aria-label="Total esfera privada: ${totaisEsfera.privada.count.toLocaleString('pt-BR')} museus, ${totaisEsfera.privada.perc.toFixed(2)}% do total geral">
                        <div class="esfera-cell" aria-hidden="true">
                            <span class="esfera-count">${totaisEsfera.privada.count.toLocaleString('pt-BR')}</span>
                            <span class="esfera-percentage">(${totaisEsfera.privada.perc.toFixed(2)}%)</span>
                        </div>
                    </td>
                    <td class="col-esfera esfera-particular" data-label="Particular" tabindex="-1"
                        aria-label="Total museus particulares: ${totaisEsfera.particular.count.toLocaleString('pt-BR')} museus, ${totaisEsfera.particular.perc.toFixed(2)}% do total geral">
                        <div class="esfera-cell" aria-hidden="true">
                            <span class="esfera-count">${totaisEsfera.particular.count.toLocaleString('pt-BR')}</span>
                            <span class="esfera-percentage">(${totaisEsfera.particular.perc.toFixed(2)}%)</span>
                        </div>
                    </td>
                    <td class="col-esfera esfera-mista" data-label="Mista" tabindex="-1"
                        aria-label="Total esfera mista: ${totaisEsfera.mista.count.toLocaleString('pt-BR')} museus, ${totaisEsfera.mista.perc.toFixed(2)}% do total geral">
                        <div class="esfera-cell" aria-hidden="true">
                            <span class="esfera-count">${totaisEsfera.mista.count.toLocaleString('pt-BR')}</span>
                            <span class="esfera-percentage">(${totaisEsfera.mista.perc.toFixed(2)}%)</span>
                        </div>
                    </td>
                    <td class="col-esfera esfera-nao-informado" data-label="Não informado" tabindex="-1"
                        aria-label="Total sem informação: ${totaisEsfera.naoInformado.count.toLocaleString('pt-BR')} museus, ${totaisEsfera.naoInformado.perc.toFixed(2)}% do total geral">
                        <div class="esfera-cell" aria-hidden="true">
                            <span class="esfera-count">${totaisEsfera.naoInformado.count.toLocaleString('pt-BR')}</span>
                            <span class="esfera-percentage">(${totaisEsfera.naoInformado.perc.toFixed(2)}%)</span>
                        </div>
                    </td>
                `;
                tbody.appendChild(totalRow);

                reorganizarCardsMobile();

                setTimeout(() => {
                    document.querySelectorAll('.tematica-bar-fill').forEach(bar => {
                        bar.classList.add('animated');
                    });
                }, 100);
            }

            function sortTematicasTable(column) {
                const announcement = document.getElementById('tematicasAnnouncement');

                if (currentSortColumn === column) {
                    currentSortOrder = currentSortOrder === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSortColumn = column;
                    currentSortOrder = 'desc';
                }

                const sortedData = [...tematicasData].sort((a, b) => {
                    let comparison = 0;

                    if (column === 'tematica') {
                        comparison = a.label.localeCompare(b.label);
                    } else if (column === 'total') {
                        comparison = a.total - b.total;
                    } else if (column === 'publica') {
                        comparison = a.publica.count - b.publica.count;
                    } else if (column === 'privada') {
                        comparison = a.privada.count - b.privada.count;
                    } else if (column === 'particular') {
                        comparison = a.particular.count - b.particular.count;
                    } else if (column === 'mista') {
                        comparison = a.mista.count - b.mista.count;
                    } else if (column === 'nao-informado') {
                        comparison = a.naoInformado.count - b.naoInformado.count;
                    }

                    return currentSortOrder === 'asc' ? comparison : -comparison;
                });

                tematicasData.length = 0;
                tematicasData.push(...sortedData);

                document.querySelectorAll('#tematicasTable th').forEach(th => {
                    th.classList.remove('sorted-asc', 'sorted-desc');
                    if (th.dataset.sort === column) {
                        th.classList.add(`sorted-${currentSortOrder}`);
                    }
                });

                renderTable();

                const orderText = currentSortOrder === 'asc' ? 'crescente' : 'decrescente';
                const columnNames = {
                    'tematica': 'temática',
                    'total': 'total de museus',
                    'publica': 'museus públicos',
                    'privada': 'museus privados',
                    'particular': 'museus particulares',
                    'mista': 'museus de esfera mista',
                    'nao-informado': 'museus sem informação'
                };
                announcement.textContent = `Tabela ordenada por ${columnNames[column]} em ordem ${orderText}`;
            }

            function initTematicasSort() {
                document.querySelectorAll('#tematicasTable th.sortable').forEach(th => {
                    th.addEventListener('click', () => {
                        sortTematicasTable(th.dataset.sort);
                    });

                    th.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            sortTematicasTable(th.dataset.sort);
                        }
                    });
                });
            }

            const table = document.getElementById('tematicasTable');
            let tableActive = false;
            let previousFocusElement = null;

            table.addEventListener('keydown', (event) => {
                const allCells = Array.from(table.querySelectorAll('td, th'));
                const focusableCells = allCells.filter(cell => cell.getAttribute('tabindex') === '0');
                const currentIndex = focusableCells.indexOf(document.activeElement);

                if ((event.key === 'Enter' || event.key === ' ') && !tableActive) {
                    event.preventDefault();
                    tableActive = true;
                    previousFocusElement = document.activeElement;

                    allCells.forEach(cell => cell.setAttribute('tabindex', '0'));

                    const firstBodyCell = table.querySelector('tbody td');
                    if (firstBodyCell) firstBodyCell.focus();

                    const announcement = document.getElementById('tematicasAnnouncement');
                    announcement.textContent = 'Modo de navegação na tabela ativado. Use Tab ou Shift+Tab para percorrer as células. Pressione ESC para sair.';
                }

                if (event.key === 'Escape' && tableActive) {
                    event.preventDefault();
                    tableActive = false;

                    allCells.forEach(cell => cell.setAttribute('tabindex', '-1'));

                    table.setAttribute('tabindex', '0');
                    table.focus();

                    const announcement = document.getElementById('tematicasAnnouncement');
                    announcement.textContent = 'Saiu da tabela. Foco retornado à tabela.';
                }
            });

            function reorganizarCardsMobile() {
                if (window.innerWidth <= 1024) {
                    const rows = document.querySelectorAll('.tematicas-table tbody tr');

                    rows.forEach(row => {
                        if (row.querySelector('.card-row-1')) return;

                        const tematica = row.querySelector('.col-tematica');
                        const total = row.querySelector('.col-total');
                        const publica = row.querySelector('.esfera-publica');
                        const privada = row.querySelector('.esfera-privada');
                        const particular = row.querySelector('.esfera-particular');
                        const mista = row.querySelector('.esfera-mista');
                        const naoInformado = row.querySelector('.esfera-nao-informado');

                        row.innerHTML = '';

                        row.appendChild(tematica);

                        const row1 = document.createElement('div');
                        row1.className = 'card-row-1';
                        row1.appendChild(total);
                        row1.appendChild(publica);
                        row1.appendChild(privada);

                        const row2 = document.createElement('div');
                        row2.className = 'card-row-2';
                        row2.appendChild(particular);
                        row2.appendChild(mista);
                        row2.appendChild(naoInformado);

                        row.appendChild(row1);
                        row.appendChild(row2);
                    });
                } else {
                    restaurarTabelaDesktop();
                }
            }

            function restaurarTabelaDesktop() {
                const rows = document.querySelectorAll('.tematicas-table tbody tr');

                rows.forEach(row => {
                    if (!row.querySelector('.card-row-1')) return;

                    const tematica = row.querySelector('.col-tematica');
                    const row1 = row.querySelector('.card-row-1');
                    const row2 = row.querySelector('.card-row-2');

                    const total = row1.querySelector('.col-total');
                    const publica = row1.querySelector('.esfera-publica');
                    const privada = row1.querySelector('.esfera-privada');
                    const particular = row2.querySelector('.esfera-particular');
                    const mista = row2.querySelector('.esfera-mista');
                    const naoInformado = row2.querySelector('.esfera-nao-informado');

                    row.innerHTML = '';

                    row.appendChild(tematica);
                    row.appendChild(total);
                    row.appendChild(publica);
                    row.appendChild(privada);
                    row.appendChild(particular);
                    row.appendChild(mista);
                    row.appendChild(naoInformado);
                });
            }

            window.addEventListener('resize', reorganizarCardsMobile);

            renderTable();
            initTematicasSort();

            document.querySelector('#tematicasTable th[data-sort="total"]').classList.add('sorted-desc');
        });

        // ========== Grafico ==========
        let varAcessivel = 'acessível';
        let varParcAcessivel = 'possui alguns recursos';
        let varNaoAcessivel = 'sem recursos';
        let varSemRecursos = 'sem informações';

        const dataByeSphere = {

            todos: [
                { percentage: 8, total: 321, color: '#2d9f4f', label: varAcessivel },
                { percentage: 34.9, total: 1403, color: '#f5b800', label: varParcAcessivel },
                { percentage: 29.4, total: 1182, color: '#e74c5c', label: varNaoAcessivel },
                { percentage: 27.8, total: 1118, color: '#6b7885', label: varSemRecursos }
            ],
            publica: [
                { percentage: 7.9, total: 206, color: '#2d9f4f', label: varAcessivel },
                { percentage: 36.7, total: 960, color: '#f5b800', label: varParcAcessivel },
                { percentage: 32.0, total: 836, color: '#e74c5c', label: varNaoAcessivel },
                { percentage: 23.5, total: 614, color: '#6b7885', label: varSemRecursos }
            ],
            privada: [
                { percentage: 8.0, total: 95, color: '#2d9f4f', label: varAcessivel },
                { percentage: 31.4, total: 372, color: '#f5b800', label: varParcAcessivel },
                { percentage: 23.7, total: 280, color: '#e74c5c', label: varNaoAcessivel },
                { percentage: 36.9, total: 436, color: '#6b7885', label: varSemRecursos }
            ],
            particular: [
                { percentage: 10.6, total: 15, color: '#2d9f4f', label: varAcessivel },
                { percentage: 36.9, total: 52, color: '#f5b800', label: varParcAcessivel },
                { percentage: 33.3, total: 47, color: '#e74c5c', label: varNaoAcessivel },
                { percentage: 19.1, total: 27, color: '#6b7885', label: varSemRecursos }
            ],
            mista: [
                { percentage: 21.7, total: 5, color: '#2d9f4f', label: varAcessivel },
                { percentage: 60.9, total: 14, color: '#f5b800', label: varParcAcessivel },
                { percentage: 17.4, total: 4, color: '#e74c5c', label: varNaoAcessivel },
                { percentage: 0.0, total: 0, color: '#6b7885', label: varSemRecursos }
            ],
            'nao-informada': [
                { percentage: 0.0, total: 0, color: '#2d9f4f', label: varAcessivel },
                { percentage: 8.2, total: 5, color: '#f5b800', label: varParcAcessivel },
                { percentage: 24.6, total: 15, color: '#e74c5c', label: varNaoAcessivel },
                { percentage: 67.2, total: 41, color: '#6b7885', label: varSemRecursos }
            ]
        };

        let statsData = [...dataByeSphere.todos];
        const COLUMNS = 10;
        const TOTAL_SQUARES = 100;
        const ANIMATION_CONFIG = { squareDelay: 8, numberDuration: 800, easing: 'easeOutCubic' };

        function easeOutCubic(t) {
            return 1 - Math.pow(1 - t, 3);
        }

        function animateNumber(element, start, end, duration, isPercentage = false) {
            const startTime = performance.now();
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easedProgress = easeOutCubic(progress);
                const currentValue = start + (end - start) * easedProgress;

                if (isPercentage) {
                    element.textContent = `${currentValue.toLocaleString('pt-BR', {
                        minimumFractionDigits: 1,
                        maximumFractionDigits: 1
                    })}%`;
                } else {
                    element.textContent = Math.round(currentValue).toLocaleString('pt-BR');
                }

                if (progress < 1) requestAnimationFrame(update);
            }
            requestAnimationFrame(update);
        }

        function animateSquares(container, oldCount, newCount, color) {
            const squares = container.querySelectorAll('.square');
            const isIncreasing = newCount > oldCount;
            const start = Math.min(oldCount, newCount);
            const end = Math.max(oldCount, newCount);

            for (let i = start; i < end; i++) {
                const square = squares[i];
                const delay = (i - start) * ANIMATION_CONFIG.squareDelay;

                setTimeout(() => {
                    square.classList.add('animating');
                    if (isIncreasing) {
                        square.classList.remove('empty');
                        square.classList.add('filled');
                        square.style.backgroundColor = color;
                    } else {
                        square.classList.remove('filled');
                        square.classList.add('empty');
                        square.style.backgroundColor = '';
                    }
                    setTimeout(() => square.classList.remove('animating'), 150);
                }, delay);
            }
        }

        function createStatItem(data) {
            const { percentage, total, color, label } = data;
            const filledSquares = Math.round((percentage / 100) * TOTAL_SQUARES);

            const statItem = document.createElement('div');
            statItem.className = 'stat-item';
            statItem.setAttribute('role', 'article');
            statItem.setAttribute('tabindex', '0');
            statItem.setAttribute('aria-label', `${percentage}% dos museus ${label}. Total: ${total} museus cadastrados`);

            const percentageDiv = document.createElement('div');
            percentageDiv.className = 'percentage';
            percentageDiv.style.color = color;
            percentageDiv.textContent = `${percentage.toLocaleString('pt-BR')}%`;
            percentageDiv.setAttribute('aria-hidden', 'true');

            const totalDiv = document.createElement('div');
            totalDiv.className = 'total';
            totalDiv.textContent = total.toLocaleString('pt-BR');
            totalDiv.setAttribute('aria-hidden', 'true');

            const labelDiv = document.createElement('div');
            labelDiv.className = 'label';
            labelDiv.textContent = label;
            labelDiv.setAttribute('aria-hidden', 'true');

            const grid = document.createElement('div');
            grid.className = 'grid';
            grid.setAttribute('role', 'img');
            grid.setAttribute('aria-label', `Representação visual: ${filledSquares} de ${TOTAL_SQUARES} quadrados preenchidos`);

            const rows = Math.ceil(TOTAL_SQUARES / COLUMNS);
            let squareIndex = 0;

            for (let row = 0; row < rows; row++) {
                const gridRow = document.createElement('div');
                gridRow.className = 'grid-row';

                for (let col = 0; col < COLUMNS; col++) {
                    const square = document.createElement('div');
                    square.className = 'square';

                    if (squareIndex < filledSquares) {
                        square.classList.add('filled');
                        square.style.backgroundColor = color;
                    } else {
                        square.classList.add('empty');
                    }

                    square.setAttribute('aria-hidden', 'true');
                    gridRow.appendChild(square);
                    squareIndex++;
                }
                grid.appendChild(gridRow);
            }

            statItem.appendChild(percentageDiv);
            statItem.appendChild(totalDiv);
            statItem.appendChild(labelDiv);
            statItem.appendChild(grid);

            return statItem;
        }

        function renderStats(animate = false) {
            const container = document.getElementById('statsContainer');

            if (!animate || container.children.length === 0) {
                container.innerHTML = '';
                statsData.forEach(data => {
                    const statItem = createStatItem(data);
                    container.appendChild(statItem);
                });
                return;
            }

            const statItems = container.querySelectorAll('.stat-item');
            statsData.forEach((data, index) => {
                if (statItems[index]) {
                    updateStatItemAnimated(statItems[index], data);
                }
            });
        }

        function updateStatItemAnimated(statItem, newData) {
            const { percentage, total, color, label } = newData;
            const newFilledSquares = Math.round((percentage / 100) * TOTAL_SQUARES);

            statItem.setAttribute('aria-label', `${percentage}% dos museus ${label}. Total: ${total} museus cadastrados`);

            const percentageDiv = statItem.querySelector('.percentage');
            const totalDiv = statItem.querySelector('.total');
            const grid = statItem.querySelector('.grid');
            const labelDiv = statItem.querySelector('.label');

            const oldPercentageText = percentageDiv.textContent.replace('%', '').replace(',', '.');
            const oldPercentage = parseFloat(oldPercentageText) || 0;
            const oldTotalText = totalDiv.textContent.replace(/\./g, '');
            const oldTotal = parseInt(oldTotalText) || 0;
            const oldFilledSquares = grid.querySelectorAll('.square.filled').length;

            labelDiv.textContent = label;

            percentageDiv.style.color = color;

            grid.setAttribute('aria-label', `Representação visual: ${newFilledSquares} de ${TOTAL_SQUARES} quadrados preenchidos`);

            animateNumber(percentageDiv, oldPercentage, percentage, ANIMATION_CONFIG.numberDuration, true);
            animateNumber(totalDiv, oldTotal, total, ANIMATION_CONFIG.numberDuration, false);
            animateSquares(grid, oldFilledSquares, newFilledSquares, color);
        }

        function updateStatsBySphere(sphere) {
            if (dataByeSphere[sphere]) {
                statsData = [...dataByeSphere[sphere]];
                renderStats(true);

                const announcement = document.getElementById('statsAnnouncement');
                if (announcement) {
                    const sphereNames = {
                        'todos': 'Todos os museus',
                        'publica': 'Museus públicos',
                        'privada': 'Museus privados',
                        'particular': 'Museus particulares',
                        'mista': 'Museus de esfera mista',
                        'nao-informada': 'Museus com esfera não informada'
                    };

                    const total = statsData.reduce((sum, item) => sum + item.total, 0);
                    announcement.textContent = `Dados atualizados para ${sphereNames[sphere]}. Total: ${total} museus. Os gráficos foram atualizados com as novas porcentagens.`;
                }
            }
        }
        function updateAriaDescription(sphere) {
            const description = document.getElementById('statsDescription');
            if (!description) return;

            const data = dataByeSphere[sphere];
            const sphereNames = {
                'todos': 'Todos os museus',
                'publica': 'Museus públicos',
                'privada': 'Museus privados',
                'particular': 'Museus particulares',
                'mista': 'Museus de esfera mista',
                'nao-informada': 'Museus com esfera não informada'
            };

            const total = data.reduce((sum, item) => sum + item.total, 0);
            const sphereName = sphereNames[sphere] || 'Museus';

            const details = data.map(item =>
                `${item.percentage}% ${item.label}: ${item.total} museus`
            ).join(', ');

            description.textContent = `${sphereName}: total de ${total} museus. ${details}`;
        }
        document.addEventListener('DOMContentLoaded', () => {
            renderStats(false);
            initSphereFilter();
            updateAriaDescription('todos'); // Descrição inicial
        });

        // ========== Museus por estado ==========
        const museusPorEstado = [
            { estado: 'SP', nomeCompleto: 'São Paulo', total: 698, acessivel: 9.5, totalAcessivel: 66, parcial: 35.1, totalParcial: 245, sem: 33.8, totalSem: 236, insuf: 21.6, totalInsuf: 151 },
            { estado: 'RS', nomeCompleto: 'Rio Grande do Sul', total: 496, acessivel: 5.2, totalAcessivel: 26, parcial: 34.9, totalParcial: 173, sem: 23.6, totalSem: 117, insuf: 36.3, totalInsuf: 180 },
            { estado: 'MG', nomeCompleto: 'Minas Gerais', total: 477, acessivel: 9.2, totalAcessivel: 44, parcial: 39.2, totalParcial: 187, sem: 49.9, totalSem: 238, insuf: 1.7, totalInsuf: 8 },
            { estado: 'RJ', nomeCompleto: 'Rio de Janeiro', total: 334, acessivel: 10.2, totalAcessivel: 34, parcial: 35.0, totalParcial: 117, sem: 26.9, totalSem: 90, insuf: 27.8, totalInsuf: 93 },
            { estado: 'PR', nomeCompleto: 'Paraná', total: 314, acessivel: 6.1, totalAcessivel: 19, parcial: 27.4, totalParcial: 86, sem: 19.4, totalSem: 61, insuf: 47.1, totalInsuf: 148 },
            { estado: 'SC', nomeCompleto: 'Santa Catarina', total: 254, acessivel: 6.7, totalAcessivel: 17, parcial: 40.9, totalParcial: 104, sem: 24.4, totalSem: 62, insuf: 28.0, totalInsuf: 71 },
            { estado: 'BA', nomeCompleto: 'Bahia', total: 191, acessivel: 6.8, totalAcessivel: 13, parcial: 28.8, totalParcial: 55, sem: 30.4, totalSem: 58, insuf: 34.0, totalInsuf: 65 },
            { estado: 'CE', nomeCompleto: 'Ceará', total: 183, acessivel: 6.6, totalAcessivel: 12, parcial: 35.5, totalParcial: 65, sem: 19.1, totalSem: 35, insuf: 38.8, totalInsuf: 71 },
            { estado: 'PE', nomeCompleto: 'Pernambuco', total: 141, acessivel: 10.6, totalAcessivel: 15, parcial: 40.4, totalParcial: 57, sem: 25.5, totalSem: 36, insuf: 23.4, totalInsuf: 33 },
            { estado: 'PB', nomeCompleto: 'Paraíba', total: 101, acessivel: 4.0, totalAcessivel: 4, parcial: 26.7, totalParcial: 27, sem: 25.7, totalSem: 26, insuf: 43.6, totalInsuf: 44 },
            { estado: 'DF', nomeCompleto: 'Distrito Federal', total: 90, acessivel: 12.2, totalAcessivel: 11, parcial: 42.2, totalParcial: 38, sem: 33.3, totalSem: 30, insuf: 12.2, totalInsuf: 11 },
            { estado: 'RN', nomeCompleto: 'Rio Grande do Norte', total: 89, acessivel: 5.6, totalAcessivel: 5, parcial: 30.3, totalParcial: 27, sem: 21.3, totalSem: 19, insuf: 42.7, totalInsuf: 38 },
            { estado: 'ES', nomeCompleto: 'Espírito Santo', total: 84, acessivel: 10.7, totalAcessivel: 9, parcial: 60.7, totalParcial: 51, sem: 26.2, totalSem: 22, insuf: 2.4, totalInsuf: 2 },
            { estado: 'GO', nomeCompleto: 'Goiás', total: 83, acessivel: 8.4, totalAcessivel: 7, parcial: 37.3, totalParcial: 31, sem: 28.9, totalSem: 24, insuf: 25.3, totalInsuf: 21 },
            { estado: 'AL', nomeCompleto: 'Alagoas', total: 67, acessivel: 0.0, totalAcessivel: 0, parcial: 28.4, totalParcial: 19, sem: 22.4, totalSem: 15, insuf: 49.3, totalInsuf: 33 },
            { estado: 'PA', nomeCompleto: 'Pará', total: 63, acessivel: 11.1, totalAcessivel: 7, parcial: 39.7, totalParcial: 25, sem: 28.6, totalSem: 18, insuf: 20.6, totalInsuf: 13 },
            { estado: 'MS', nomeCompleto: 'Mato Grosso do Sul', total: 60, acessivel: 3.3, totalAcessivel: 2, parcial: 20.0, totalParcial: 12, sem: 28.3, totalSem: 17, insuf: 48.3, totalInsuf: 29 },
            { estado: 'MT', nomeCompleto: 'Mato Grosso', total: 55, acessivel: 7.3, totalAcessivel: 4, parcial: 23.6, totalParcial: 13, sem: 20.0, totalSem: 11, insuf: 49.1, totalInsuf: 27 },
            { estado: 'MA', nomeCompleto: 'Maranhão', total: 54, acessivel: 16.7, totalAcessivel: 9, parcial: 29.6, totalParcial: 16, sem: 31.5, totalSem: 17, insuf: 22.2, totalInsuf: 12 },
            { estado: 'AM', nomeCompleto: 'Amazonas', total: 48, acessivel: 12.5, totalAcessivel: 6, parcial: 22.9, totalParcial: 11, sem: 27.1, totalSem: 13, insuf: 37.5, totalInsuf: 18 },
            { estado: 'SE', nomeCompleto: 'Sergipe', total: 34, acessivel: 11.8, totalAcessivel: 4, parcial: 35.3, totalParcial: 12, sem: 23.5, totalSem: 8, insuf: 29.4, totalInsuf: 10 },
            { estado: 'PI', nomeCompleto: 'Piauí', total: 33, acessivel: 6.1, totalAcessivel: 2, parcial: 33.3, totalParcial: 11, sem: 27.3, totalSem: 9, insuf: 33.3, totalInsuf: 11 },
            { estado: 'AC', nomeCompleto: 'Acre', total: 24, acessivel: 8.3, totalAcessivel: 2, parcial: 12.5, totalParcial: 3, sem: 20.8, totalSem: 5, insuf: 58.3, totalInsuf: 14 },
            { estado: 'TO', nomeCompleto: 'Tocantins', total: 21, acessivel: 4.8, totalAcessivel: 1, parcial: 42.9, totalParcial: 9, sem: 23.8, totalSem: 5, insuf: 28.6, totalInsuf: 6 },
            { estado: 'RO', nomeCompleto: 'Rondônia', total: 18, acessivel: 11.1, totalAcessivel: 2, parcial: 27.8, totalParcial: 5, sem: 27.8, totalSem: 5, insuf: 33.3, totalInsuf: 6 },
            { estado: 'AP', nomeCompleto: 'Amapá', total: 9, acessivel: 0.0, totalAcessivel: 0, parcial: 33.3, totalParcial: 3, sem: 33.3, totalSem: 3, insuf: 33.3, totalInsuf: 3 },
            { estado: 'RR', nomeCompleto: 'Roraima', total: 3, acessivel: 0.0, totalAcessivel: 0, parcial: 33.3, totalParcial: 1, sem: 66.7, totalSem: 2, insuf: 0.0, totalInsuf: 0 }
        ];

        let currentSortColumn = 'total';
        let currentSortOrder = 'desc';

        function createMiniBar(percentage, count, colorClass, categoryLabel) {
            const container = document.createElement('div');
            container.className = 'sparkline-mini-bar';

            const barVisual = document.createElement('div');
            barVisual.className = `bar-visual ${colorClass}`;
            barVisual.style.width = `${percentage}%`;
            barVisual.setAttribute('aria-hidden', 'true');

            const barInfo = document.createElement('div');
            barInfo.className = 'bar-info';

            const text = document.createElement('span');
            text.className = 'bar-percentage';
            text.textContent = `${percentage.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 })}% (${count})`;

            barInfo.appendChild(text);

            container.appendChild(barVisual);
            container.appendChild(barInfo);

            return container;
        }

        function createSparklineRow(data) {
            const row = document.createElement('tr');

            const estadoCell = document.createElement('td');
            estadoCell.className = 'estado-name';
            estadoCell.setAttribute('scope', 'row');
            estadoCell.setAttribute('data-label', 'Estado:');
            estadoCell.setAttribute('tabindex', '-1');
            estadoCell.setAttribute('aria-label', `Estado: ${data.nomeCompleto}`);
            const estadoText = document.createElement('span');
            estadoText.setAttribute('aria-hidden', 'true');
            estadoText.textContent = data.nomeCompleto;
            estadoCell.appendChild(estadoText);

            const totalCell = document.createElement('td');
            totalCell.className = 'total-museus';
            totalCell.setAttribute('data-label', 'Total:');
            totalCell.setAttribute('tabindex', '-1');
            totalCell.setAttribute('aria-label', `${data.total} ${data.total === 1 ? 'museu' : 'museus'} no total`);
            const totalText = document.createElement('span');
            totalText.setAttribute('aria-hidden', 'true');
            totalText.textContent = data.total.toLocaleString('pt-BR');
            totalCell.appendChild(totalText);

            const acessivelCell = document.createElement('td');
            acessivelCell.className = 'sparkline-cell';
            acessivelCell.setAttribute('data-label', 'Acessível:');
            acessivelCell.setAttribute('tabindex', '-1');
            const acessivelLabel = data.totalAcessivel === 0
                ? 'Nenhum museu com acessibilidade completa'
                : `${data.totalAcessivel} ${data.totalAcessivel === 1 ? 'museu' : 'museus'}, correspondendo a ${data.acessivel.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 })}%, com acessibilidade completa`;
            acessivelCell.setAttribute('aria-label', acessivelLabel);
            const acessivelContainer = document.createElement('div');
            acessivelContainer.className = 'category-container';
            acessivelContainer.setAttribute('aria-hidden', 'true');
            acessivelContainer.appendChild(createMiniBar(data.acessivel, data.totalAcessivel, 'acessivel', 'Acessível'));
            acessivelCell.appendChild(acessivelContainer);

            const parcialCell = document.createElement('td');
            parcialCell.className = 'sparkline-cell';
            parcialCell.setAttribute('data-label', 'Parcialmente acessível:');
            parcialCell.setAttribute('tabindex', '-1');
            const parcialLabel = data.totalParcial === 0
                ? 'Nenhum museu com alguns recursos de acessibilidade'
                : `${data.totalParcial} ${data.totalParcial === 1 ? 'museu' : 'museus'}, correspondendo a ${data.parcial.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 })}%, com alguns recursos de acessibilidade`;
            parcialCell.setAttribute('aria-label', parcialLabel);
            const parcialContainer = document.createElement('div');
            parcialContainer.className = 'category-container';
            parcialContainer.setAttribute('aria-hidden', 'true');
            parcialContainer.appendChild(createMiniBar(data.parcial, data.totalParcial, 'parcial', 'Parcial'));
            parcialCell.appendChild(parcialContainer);

            const semCell = document.createElement('td');
            semCell.className = 'sparkline-cell';
            semCell.setAttribute('data-label', 'Sem recursos:');
            semCell.setAttribute('tabindex', '-1');
            const semLabel = data.totalSem === 0
                ? 'Nenhum museu sem recursos de acessibilidade'
                : `${data.totalSem} ${data.totalSem === 1 ? 'museu' : 'museus'}, correspondendo a ${data.sem.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 })}%, sem recursos de acessibilidade`;
            semCell.setAttribute('aria-label', semLabel);
            const semContainer = document.createElement('div');
            semContainer.className = 'category-container';
            semContainer.setAttribute('aria-hidden', 'true');
            semContainer.appendChild(createMiniBar(data.sem, data.totalSem, 'sem-recursos', 'Sem recursos'));
            semCell.appendChild(semContainer);

            const insufCell = document.createElement('td');
            insufCell.className = 'sparkline-cell';
            insufCell.setAttribute('data-label', 'Sem informação:');
            insufCell.setAttribute('tabindex', '-1');
            const insufLabel = data.totalInsuf === 0
                ? 'Nenhum museu sem informação disponível'
                : `${data.totalInsuf} ${data.totalInsuf === 1 ? 'museu' : 'museus'}, correspondendo a ${data.insuf.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 1 })}%, sem informação disponível`;
            insufCell.setAttribute('aria-label', insufLabel);
            const insufContainer = document.createElement('div');
            insufContainer.className = 'category-container';
            insufContainer.setAttribute('aria-hidden', 'true');
            insufContainer.appendChild(createMiniBar(data.insuf, data.totalInsuf, 'insuficiente', 'Sem informação'));
            insufCell.appendChild(insufContainer);

            row.appendChild(estadoCell);
            row.appendChild(totalCell);
            row.appendChild(acessivelCell);
            row.appendChild(parcialCell);
            row.appendChild(semCell);
            row.appendChild(insufCell);

            return row;
        }

        function renderSparklineTable(data = museusPorEstado, showAll = false) {
            const tbody = document.getElementById('sparklineTableBody');
            tbody.innerHTML = '';

            data.forEach((estado, index) => {
                const row = createSparklineRow(estado);

                if (index >= 5 && !showAll) {
                    row.classList.add('hidden-row');
                }

                tbody.appendChild(row);
            });

            updateShowMoreButton(data.length, showAll);
        }

        function updateShowMoreButton(totalRows, showAll) {
            const button = document.getElementById('showMoreButton');
            const container = button.parentElement;

            if (totalRows <= 5) {
                container.style.display = 'none';
            } else {
                container.style.display = 'block';
                if (showAll) {
                    button.textContent = 'Exibir apenas primeiros 5';
                    button.setAttribute('aria-label', 'Recolher tabela para mostrar apenas os 5 primeiros estados');
                } else {
                    button.textContent = `Exibir todos os ${totalRows} estados`;
                    button.setAttribute('aria-label', `Expandir tabela para mostrar todos os ${totalRows} estados`);
                }
            }
        }

        function toggleShowAll() {
            const hiddenRows = document.querySelectorAll('#sparklineTableBody .hidden-row');
            const isCurrentlyHidden = hiddenRows.length > 0;

            if (isCurrentlyHidden) {
                hiddenRows.forEach(row => row.classList.remove('hidden-row'));
                updateShowMoreButton(museusPorEstado.length, true);
            } else {
                const allRows = document.querySelectorAll('#sparklineTableBody tr');
                allRows.forEach((row, index) => {
                    if (index >= 5) {
                        row.classList.add('hidden-row');
                    }
                });
                updateShowMoreButton(museusPorEstado.length, false);
            }
        }

        function toggleShowAllStatus() {
            const hiddenRows = document.querySelectorAll('#statusTableBody .hidden-row');
            const isCurrentlyHidden = hiddenRows.length > 0;

            if (isCurrentlyHidden) {
                hiddenRows.forEach(row => row.classList.remove('hidden-row'));
                updateShowMoreStatusButton(statusPorEstado.length, true);
            } else {
                const allRows = document.querySelectorAll('#statusTableBody tr');
                allRows.forEach((row, index) => {
                    if (index >= 5) {
                        row.classList.add('hidden-row');
                    }
                });
                updateShowMoreStatusButton(statusPorEstado.length, false);
            }
        }

        function toggleShowAllEntrada() {
            const hiddenRows = document.querySelectorAll('#entradaTableBody .hidden-row');
            const isCurrentlyHidden = hiddenRows.length > 0;

            if (isCurrentlyHidden) {
                hiddenRows.forEach(row => row.classList.remove('hidden-row'));
                updateShowMoreEntradaButton(entradaPorEstado.length, true);
            } else {
                const allRows = document.querySelectorAll('#entradaTableBody tr');
                allRows.forEach((row, index) => {
                    if (index >= 5) {
                        row.classList.add('hidden-row');
                    }
                });
                updateShowMoreEntradaButton(entradaPorEstado.length, false);
            }
        }

        function sortSparklineTable(column) {
            const announcement = document.getElementById('sortAnnouncement');

            if (currentSortColumn === column) {
                currentSortOrder = currentSortOrder === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumn = column;
                currentSortOrder = column === 'estado' ? 'asc' : 'desc';
            }

            const sortedData = [...museusPorEstado].sort((a, b) => {
                let comparison = 0;

                if (column === 'estado') {
                    comparison = a.estado.localeCompare(b.estado);
                } else if (column === 'total') {
                    comparison = a.total - b.total;
                } else if (column === 'acessivel') {
                    comparison = a.acessivel - b.acessivel;
                } else if (column === 'parcial') {
                    comparison = a.parcial - b.parcial;
                } else if (column === 'sem') {
                    comparison = a.sem - b.sem;
                } else if (column === 'insuf') {
                    comparison = a.insuf - b.insuf;
                }

                return currentSortOrder === 'asc' ? comparison : -comparison;
            });

            document.querySelectorAll('#sparklineTable th').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
                if (th.dataset.sort === column) {
                    th.classList.add(`sorted-${currentSortOrder}`);
                }
            });

            renderSparklineTable(sortedData);

            const orderText = currentSortOrder === 'asc' ? 'crescente' : 'decrescente';
            const columnNames = {
                'estado': 'estado',
                'total': 'total de museus',
                'acessivel': 'museus acessíveis',
                'parcial': 'museus parcialmente acessíveis',
                'sem': 'museus sem recursos',
                'insuf': 'museus sem informações'
            };
            announcement.textContent = `Tabela ordenada por ${columnNames[column]} em ordem ${orderText}`;
        }

        function initSparklineSort() {
            document.querySelectorAll('#sparklineTable th.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    sortSparklineTable(th.dataset.sort);
                });

                th.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        sortSparklineTable(th.dataset.sort);
                    }
                });
            });
        }

        const table = document.getElementById('sparklineTable');
        table.setAttribute('role', 'table');
        table.setAttribute('aria-label', 'Tabela com dados de acessibilidade dos museus de todos os estados. Pressione Enter ou Espaço para começar a navegar pelas células. Pressione ESC para sair.');

        let tableActive = false;
        let previousFocusElement = null;

        table.addEventListener('keydown', (event) => {
            const allCells = Array.from(table.querySelectorAll('td'));
            const focusableCells = allCells.filter(td => td.getAttribute('tabindex') === '0');
            const currentIndex = focusableCells.indexOf(document.activeElement);

            if ((event.key === 'Enter' || event.key === ' ') && !tableActive) {
                event.preventDefault();
                tableActive = true;
                previousFocusElement = document.activeElement;

                allCells.forEach(td => td.setAttribute('tabindex', '0'));
                focusableCells[0].focus();

                const announcement = document.getElementById('sortAnnouncement');
                announcement.textContent = 'Modo de navegação na tabela ativado. Use Tab ou Shift+Tab para percorrer as células. Pressione ESC para sair.';
            }

            if (event.key === 'Escape' && tableActive) {
                event.preventDefault();
                tableActive = false;

                allCells.forEach(td => td.setAttribute('tabindex', '-1'));

                if (previousFocusElement) previousFocusElement.focus();
                const announcement = document.getElementById('sortAnnouncement');
                announcement.textContent = 'Saiu da tabela. Foco retornado ao elemento anterior.';
            }
        });

        const statusTable = document.getElementById('statusTableByState');
        statusTable.setAttribute('role', 'table');
        statusTable.setAttribute('aria-label', 'Tabela de status de funcionamento por estado. Pressione Enter ou Espaço para começar a navegar pelas células. Pressione ESC para sair.');

        let statusTableActive = false;
        let previousFocusElementStatus = null;

        statusTable.addEventListener('keydown', (event) => {
            const allCells = Array.from(statusTable.querySelectorAll('td'));
            const focusableCells = allCells.filter(td => td.getAttribute('tabindex') === '0');
            const currentIndex = focusableCells.indexOf(document.activeElement);

            if ((event.key === 'Enter' || event.key === ' ') && !statusTableActive) {
                event.preventDefault();
                statusTableActive = true;
                previousFocusElementStatus = document.activeElement;

                allCells.forEach(td => td.setAttribute('tabindex', '0'));
                focusableCells[0].focus();

                const announcement = document.getElementById('sortAnnouncementStatus');
                announcement.textContent = 'Modo de navegação na tabela ativado. Use Tab ou Shift+Tab para percorrer as células. Pressione ESC para sair.';
            }

            if (event.key === 'Escape' && statusTableActive) {
                event.preventDefault();
                statusTableActive = false;

                allCells.forEach(td => td.setAttribute('tabindex', '-1'));

                if (previousFocusElementStatus) previousFocusElementStatus.focus();
                const announcement = document.getElementById('sortAnnouncementStatus');
                announcement.textContent = 'Saiu da tabela. Foco retornado ao elemento anterior.';
            }
        });

        document.getElementById('showMoreStatusButton').addEventListener('click', () => {
            toggleShowAllStatus();
            setTimeout(() => {
                const table = document.getElementById('statusTableByState');
                if (table) {
                    table.focus();

                    const announcement = document.getElementById('sortAnnouncementStatus');
                    announcement.textContent = 'Tabela expandida. Agora todos os 27 estados estão visíveis. Pressione Enter ou Espaço para começar a navegar pelas células.';
                }
            }, 200);
        });

        document.getElementById('showMoreButton').addEventListener('click', () => {
            setTimeout(() => {
                const table = document.getElementById('sparklineTable');
                if (table) {
                    table.focus();
                    const announcement = document.getElementById('sortAnnouncement');
                    announcement.textContent = 'Tabela expandida. Agora todos os 27 estados estão visíveis. Pressione Enter ou Espaço para começar a navegar pelas células.';
                }
            }, 200);
        });

        // ========== Status de funcionamento ==========
        const statusData = [
            {
                title: 'Total',
                total: 4024,
                abertos: { count: 3635, percentage: 90.33 },
                fechados: { count: 387, percentage: 9.62 }
            },
            {
                title: 'Pública',
                total: 2616,
                abertos: { count: 2352, percentage: 89.91 },
                fechados: { count: 264, percentage: 10.09 }
            },
            {
                title: 'Privada',
                total: 1183,
                abertos: { count: 1080, percentage: 91.29 },
                fechados: { count: 103, percentage: 8.71 }
            },
            {
                title: 'Particular',
                total: 141,
                abertos: { count: 132, percentage: 93.62 },
                fechados: { count: 9, percentage: 6.38 }
            },
            {
                title: 'Não informado',
                total: 59,
                abertos: { count: 52, percentage: 88.14 },
                fechados: { count: 7, percentage: 11.86 }
            },
            {
                title: 'Mista',
                total: 23,
                abertos: { count: 19, percentage: 82.61 },
                fechados: { count: 4, percentage: 17.39 }
            }
        ];

        function createStatusItem(data) {
            const { title, total, abertos, fechados } = data;

            const statusItem = document.createElement('div');
            statusItem.className = 'status-item';
            statusItem.setAttribute('role', 'article');
            statusItem.setAttribute('tabindex', '0');
            statusItem.setAttribute('aria-label', `${title}: ${total} museus no total. ${abertos.count} abertos (${abertos.percentage}%) e ${fechados.count} fechados (${fechados.percentage}%)`);

            const titleDiv = document.createElement('div');
            titleDiv.className = 'status-title';
            titleDiv.textContent = title;
            titleDiv.setAttribute('aria-hidden', 'true');

            const barContainer = document.createElement('div');
            barContainer.className = 'status-bar-container';

            const stackedBar = document.createElement('div');
            stackedBar.className = 'status-stacked-bar';
            stackedBar.setAttribute('role', 'img');
            stackedBar.setAttribute('aria-label', `Barra mostrando ${abertos.count} abertos e ${fechados.count} fechados`);

            const abertosSegment = document.createElement('div');
            abertosSegment.className = 'status-bar-segment bar-aberto';
            abertosSegment.style.width = '0%';
            abertosSegment.setAttribute('data-width', abertos.percentage);
            const abertosText = document.createElement('span');
            abertosText.className = 'status-bar-segment-text';
            abertosText.textContent = abertos.count.toLocaleString('pt-BR');
            abertosSegment.appendChild(abertosText);

            const fechadosSegment = document.createElement('div');
            fechadosSegment.className = 'status-bar-segment bar-fechado';
            fechadosSegment.style.width = '0%';
            fechadosSegment.setAttribute('data-width', fechados.percentage);
            const fechadosText = document.createElement('span');
            fechadosText.className = 'status-bar-segment-text';
            fechadosText.textContent = fechados.count.toLocaleString('pt-BR');
            fechadosSegment.appendChild(fechadosText);

            stackedBar.appendChild(abertosSegment);
            stackedBar.appendChild(fechadosSegment);
            barContainer.appendChild(stackedBar);

            const detailsDiv = document.createElement('div');
            detailsDiv.className = 'status-details';
            detailsDiv.setAttribute('aria-hidden', 'true');

            const abertosDetail = document.createElement('div');
            abertosDetail.className = 'status-detail-item';
            abertosDetail.innerHTML = `
                <div class="status-detail-label">
                    <div class="status-detail-color bar-aberto"></div>
                    <span>Abertos</span>
                </div>
                <div class="status-detail-value">${abertos.count.toLocaleString('pt-BR')} <span>(${abertos.percentage.toLocaleString('pt-BR')}%)</span></div>
            `;

            const fechadosDetail = document.createElement('div');
            fechadosDetail.className = 'status-detail-item';
            fechadosDetail.innerHTML = `
                <div class="status-detail-label">
                    <div class="status-detail-color bar-fechado"></div>
                    <span>Fechados</span>
                </div>
                <div class="status-detail-value">${fechados.count.toLocaleString('pt-BR')} <span>(${fechados.percentage.toLocaleString('pt-BR')}%)</span></div>
            `;

            detailsDiv.appendChild(abertosDetail);
            detailsDiv.appendChild(fechadosDetail);

            const totalLine = document.createElement('div');
            totalLine.className = 'status-total-line';
            totalLine.innerHTML = `
                <div class="status-total-label">Total de museus</div>
                <div class="status-total-value">${total.toLocaleString('pt-BR')}</div>
            `;

            statusItem.appendChild(titleDiv);
            statusItem.appendChild(barContainer);
            statusItem.appendChild(detailsDiv);
            statusItem.appendChild(totalLine);

            return statusItem;
        }

        function animateStatusBars() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const segments = entry.target.querySelectorAll('.status-bar-segment');
                        segments.forEach((segment, index) => {
                            setTimeout(() => {
                                const width = segment.getAttribute('data-width');
                                segment.style.width = width + '%';
                                setTimeout(() => {
                                    segment.classList.add('animated');
                                }, 150);
                            }, index * 100);
                        });
                        observer.unobserve(entry.target);
                    }
                });
            }, {
                threshold: 0.2
            });

            document.querySelectorAll('.status-stacked-bar').forEach(bar => {
                observer.observe(bar);
            });
        }

        function renderStatusGrid() {
            const container = document.getElementById('statusContainer');
            container.innerHTML = '';

            statusData.forEach(data => {
                const statusItem = createStatusItem(data);
                container.appendChild(statusItem);
            });

            animateStatusBars();
        }

        const statusPorEstado = [
            { estado: 'SP', nomeCompleto: 'São Paulo', total: 698, abertos: 623, percAbertos: 89.26, fechados: 75, percFechados: 10.74 },
            { estado: 'RS', nomeCompleto: 'Rio Grande do Sul', total: 496, abertos: 460, percAbertos: 92.74, fechados: 36, percFechados: 7.26 },
            { estado: 'MG', nomeCompleto: 'Minas Gerais', total: 477, abertos: 425, percAbertos: 89.1, fechados: 52, percFechados: 10.9 },
            { estado: 'RJ', nomeCompleto: 'Rio de Janeiro', total: 334, abertos: 304, percAbertos: 91.02, fechados: 30, percFechados: 8.98 },
            { estado: 'PR', nomeCompleto: 'Paraná', total: 314, abertos: 284, percAbertos: 90.45, fechados: 30, percFechados: 9.55 },
            { estado: 'SC', nomeCompleto: 'Santa Catarina', total: 254, abertos: 231, percAbertos: 90.94, fechados: 23, percFechados: 9.06 },
            { estado: 'BA', nomeCompleto: 'Bahia', total: 191, abertos: 162, percAbertos: 84.82, fechados: 29, percFechados: 15.18 },
            { estado: 'CE', nomeCompleto: 'Ceará', total: 183, abertos: 170, percAbertos: 92.9, fechados: 13, percFechados: 7.1 },
            { estado: 'PE', nomeCompleto: 'Pernambuco', total: 141, abertos: 120, percAbertos: 85.11, fechados: 21, percFechados: 14.89 },
            { estado: 'PB', nomeCompleto: 'Paraíba', total: 101, abertos: 99, percAbertos: 98.02, fechados: 2, percFechados: 1.98 },
            { estado: 'DF', nomeCompleto: 'Distrito Federal', total: 90, abertos: 87, percAbertos: 96.67, fechados: 3, percFechados: 3.33 },
            { estado: 'RN', nomeCompleto: 'Rio Grande do Norte', total: 89, abertos: 80, percAbertos: 89.89, fechados: 9, percFechados: 10.11 },
            { estado: 'ES', nomeCompleto: 'Espírito Santo', total: 84, abertos: 74, percAbertos: 88.1, fechados: 10, percFechados: 11.9 },
            { estado: 'GO', nomeCompleto: 'Goiás', total: 83, abertos: 74, percAbertos: 89.16, fechados: 9, percFechados: 10.84 },
            { estado: 'AL', nomeCompleto: 'Alagoas', total: 67, abertos: 62, percAbertos: 92.54, fechados: 5, percFechados: 7.46 },
            { estado: 'PA', nomeCompleto: 'Pará', total: 63, abertos: 61, percAbertos: 96.83, fechados: 2, percFechados: 3.17 },
            { estado: 'MS', nomeCompleto: 'Mato Grosso do Sul', total: 60, abertos: 52, percAbertos: 86.67, fechados: 8, percFechados: 13.33 },
            { estado: 'MT', nomeCompleto: 'Mato Grosso', total: 55, abertos: 50, percAbertos: 90.91, fechados: 5, percFechados: 9.09 },
            { estado: 'MA', nomeCompleto: 'Maranhão', total: 54, abertos: 47, percAbertos: 87.04, fechados: 7, percFechados: 12.96 },
            { estado: 'AM', nomeCompleto: 'Amazonas', total: 48, abertos: 46, percAbertos: 95.83, fechados: 2, percFechados: 4.17 },
            { estado: 'SE', nomeCompleto: 'Sergipe', total: 34, abertos: 32, percAbertos: 94.12, fechados: 2, percFechados: 5.88 },
            { estado: 'PI', nomeCompleto: 'Piauí', total: 33, abertos: 33, percAbertos: 100.0, fechados: 0, percFechados: 0.0 },
            { estado: 'AC', nomeCompleto: 'Acre', total: 24, abertos: 16, percAbertos: 66.67, fechados: 8, percFechados: 33.33 },
            { estado: 'TO', nomeCompleto: 'Tocantins', total: 21, abertos: 20, percAbertos: 95.24, fechados: 1, percFechados: 4.76 },
            { estado: 'RO', nomeCompleto: 'Rondônia', total: 18, abertos: 15, percAbertos: 83.33, fechados: 3, percFechados: 16.67 },
            { estado: 'AP', nomeCompleto: 'Amapá', total: 9, abertos: 9, percAbertos: 100.0, fechados: 0, percFechados: 0.0 },
            { estado: 'RR', nomeCompleto: 'Roraima', total: 3, abertos: 1, percAbertos: 33.33, fechados: 2, percFechados: 66.67 }
        ];

        let currentSortColumnStatus = 'total';
        let currentSortOrderStatus = 'desc';

        function createStatusRow(data) {
            const row = document.createElement('tr');

            const estadoCell = document.createElement('td');
            estadoCell.className = 'estado-name';
            estadoCell.setAttribute('scope', 'row');
            estadoCell.setAttribute('data-label', 'Estado:');
            estadoCell.setAttribute('tabindex', '-1');
            estadoCell.setAttribute('aria-label', `Estado: ${data.nomeCompleto}`);
            const estadoText = document.createElement('span');
            estadoText.setAttribute('aria-hidden', 'true');
            estadoText.textContent = data.nomeCompleto;
            estadoCell.appendChild(estadoText);

            const totalCell = document.createElement('td');
            totalCell.className = 'total-museus';
            totalCell.setAttribute('data-label', 'Total:');
            totalCell.setAttribute('tabindex', '-1');
            totalCell.setAttribute('aria-label', `${data.total} ${data.total === 1 ? 'museu' : 'museus'} no total`);
            const totalText = document.createElement('span');
            totalText.setAttribute('aria-hidden', 'true');
            totalText.textContent = data.total.toLocaleString('pt-BR');
            totalCell.appendChild(totalText);

            const abertosCell = document.createElement('td');
            abertosCell.className = 'sparkline-cell';
            abertosCell.setAttribute('data-label', 'Abertos:');
            abertosCell.setAttribute('tabindex', '-1');
            const abertosLabel = data.abertos === 0
                ? 'Nenhum museu aberto'
                : `${data.abertos} ${data.abertos === 1 ? 'museu aberto' : 'museus abertos'}, correspondendo a ${data.percAbertos.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 2 })}%`;
            abertosCell.setAttribute('aria-label', abertosLabel);
            const abertosContainer = document.createElement('div');
            abertosContainer.className = 'category-container';
            abertosContainer.setAttribute('aria-hidden', 'true');
            abertosContainer.appendChild(createMiniBar(data.percAbertos, data.abertos, 'acessivel', 'Abertos'));
            abertosCell.appendChild(abertosContainer);

            const fechadosCell = document.createElement('td');
            fechadosCell.className = 'sparkline-cell';
            fechadosCell.setAttribute('data-label', 'Fechados:');
            fechadosCell.setAttribute('tabindex', '-1');
            const fechadosLabel = data.fechados === 0
                ? 'Nenhum museu fechado'
                : `${data.fechados} ${data.fechados === 1 ? 'museu fechado' : 'museus fechados'}, correspondendo a ${data.percFechados.toLocaleString('pt-BR', { minimumFractionDigits: 1, maximumFractionDigits: 2 })}%`;
            fechadosCell.setAttribute('aria-label', fechadosLabel);
            const fechadosContainer = document.createElement('div');
            fechadosContainer.className = 'category-container';
            fechadosContainer.setAttribute('aria-hidden', 'true');
            fechadosContainer.appendChild(createMiniBar(data.percFechados, data.fechados, 'sem-recursos', 'Fechados'));
            fechadosCell.appendChild(fechadosContainer);

            row.appendChild(estadoCell);
            row.appendChild(totalCell);
            row.appendChild(abertosCell);
            row.appendChild(fechadosCell);

            return row;
        }

        function renderStatusTable(data = statusPorEstado, showAll = false) {
            const tbody = document.getElementById('statusTableBody');
            tbody.innerHTML = '';

            data.forEach((estado, index) => {
                const row = createStatusRow(estado);

                if (index >= 5 && !showAll) {
                    row.classList.add('hidden-row');
                }

                tbody.appendChild(row);
            });

            updateShowMoreStatusButton(data.length, showAll);
        }

        function updateShowMoreStatusButton(totalRows, showAll) {
            const button = document.getElementById('showMoreStatusButton');
            const container = button.parentElement;

            if (totalRows <= 5) {
                container.style.display = 'none';
            } else {
                container.style.display = 'block';
                if (showAll) {
                    button.textContent = 'Exibir apenas primeiros 5';
                    button.setAttribute('aria-label', 'Recolher tabela para mostrar apenas os 5 primeiros estados');
                } else {
                    button.textContent = `Exibir todos os ${totalRows} estados`;
                    button.setAttribute('aria-label', `Expandir tabela para mostrar todos os ${totalRows} estados`);
                }
            }
        }

        function toggleShowAllStatus() {
            const hiddenRows = document.querySelectorAll('#statusTableBody .hidden-row');
            const isCurrentlyHidden = hiddenRows.length > 0;

            if (isCurrentlyHidden) {
                hiddenRows.forEach(row => row.classList.remove('hidden-row'));
                updateShowMoreStatusButton(statusPorEstado.length, true);
            } else {
                const allRows = document.querySelectorAll('#statusTableBody tr');
                allRows.forEach((row, index) => {
                    if (index >= 5) {
                        row.classList.add('hidden-row');
                    }
                });
                updateShowMoreStatusButton(statusPorEstado.length, false);
            }
        }

        function sortStatusTable(column) {
            const announcement = document.getElementById('sortAnnouncementStatus');

            if (currentSortColumnStatus === column) {
                currentSortOrderStatus = currentSortOrderStatus === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortColumnStatus = column;
                currentSortOrderStatus = column === 'estado' ? 'asc' : 'desc';
            }

            const sortedData = [...statusPorEstado].sort((a, b) => {
                let comparison = 0;

                if (column === 'estado') {
                    comparison = a.estado.localeCompare(b.estado);
                } else if (column === 'total') {
                    comparison = a.total - b.total;
                } else if (column === 'abertos') {
                    comparison = a.percAbertos - b.percAbertos;
                } else if (column === 'fechados') {
                    comparison = a.percFechados - b.percFechados;
                }

                return currentSortOrderStatus === 'asc' ? comparison : -comparison;
            });

            document.querySelectorAll('#statusTableByState th').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
                if (th.dataset.sort === column) {
                    th.classList.add(`sorted-${currentSortOrderStatus}`);
                }
            });

            renderStatusTable(sortedData);

            const orderText = currentSortOrderStatus === 'asc' ? 'crescente' : 'decrescente';
            const columnNames = {
                'estado': 'estado',
                'total': 'total de museus',
                'abertos': 'museus abertos',
                'fechados': 'museus fechados'
            };
            announcement.textContent = `Tabela ordenada por ${columnNames[column]} em ordem ${orderText}`;
        }

        function initStatusSort() {
            document.querySelectorAll('#statusTableByState th.sortable').forEach(th => {
                th.addEventListener('click', () => {
                    sortStatusTable(th.dataset.sort);
                });

                th.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        sortStatusTable(th.dataset.sort);
                    }
                });
            });
        }

        const sortedStatusData = [...statusPorEstado].sort((a, b) => b.percAbertos - a.percAbertos);
        renderStatusTable(sortedStatusData, false);

        currentSortColumnStatus = 'abertos';
        currentSortOrderStatus = 'desc';

        document.querySelector('#statusTableByState th[data-sort="abertos"]').classList.add('sorted-desc');

        initStatusSort();

        function initSphereFilter() {
            const radioButtons = document.querySelectorAll('input[name="sphere"]');
            radioButtons.forEach(radio => {
                radio.addEventListener('change', (e) => {
                    const selectedSphere = e.target.value;
                    updateStatsBySphere(selectedSphere);
                });
            });
        }

        // ========== Modo escuro ==========
        const darkModeToggle = document.getElementById('darkModeToggle');
        const body = document.body;

        function enableDarkMode() {
            body.classList.add('dark-mode');
            darkModeToggle.textContent = '☀️ Modo claro';
            darkModeToggle.setAttribute('aria-label', 'Alternar para modo claro');
        }

        function disableDarkMode() {
            body.classList.remove('dark-mode');
            darkModeToggle.textContent = '🌙 Modo escuro';
            darkModeToggle.setAttribute('aria-label', 'Alternar para modo escuro');
        }

        const savedMode = localStorage.getItem('darkMode');
        if (savedMode === 'enabled') {
            enableDarkMode();
        }

        darkModeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                darkModeToggle.textContent = '☀️ Modo claro';
                darkModeToggle.setAttribute('aria-label', 'Alternar para modo claro');
            } else {
                localStorage.setItem('darkMode', 'disabled');
                darkModeToggle.textContent = '🌙 Modo escuro';
                darkModeToggle.setAttribute('aria-label', 'Alternar para modo escuro');
            }
        });

        // ========== Tamanho da fonte ==========
        let currentFontSize = 100;
        const minFontSize = 75;
        const maxFontSize = 150;
        const fontSizeStep = 12.5;

        if (localStorage.getItem('fontSize')) {
            currentFontSize = parseFloat(localStorage.getItem('fontSize'));
            document.documentElement.style.fontSize = currentFontSize + '%';
        }

        document.getElementById('increaseText').addEventListener('click', () => {
            if (currentFontSize < maxFontSize) {
                currentFontSize += fontSizeStep;
                document.documentElement.style.fontSize = currentFontSize + '%';
                localStorage.setItem('fontSize', currentFontSize);
            }
        });

        document.getElementById('decreaseText').addEventListener('click', () => {
            if (currentFontSize > minFontSize) {
                currentFontSize -= fontSizeStep;
                document.documentElement.style.fontSize = currentFontSize + '%';
                localStorage.setItem('fontSize', currentFontSize);
            }
        });

        // ========== Inicio ==========
        document.addEventListener('DOMContentLoaded', () => {
            renderStats(false);
            initSphereFilter();

            currentSortColumn = 'total';
            currentSortOrder = 'desc';

            const sortedData = [...museusPorEstado].sort((a, b) => b.total - a.total);
            renderSparklineTable(sortedData, false);

            document.querySelector('.sparkline-table th[data-sort="total"]').classList.add('sorted-desc');

            initSparklineSort();

            const btnAcessibilidade = document.getElementById('showMoreButton');
            if (btnAcessibilidade) {
                btnAcessibilidade.addEventListener('click', () => {
                    setTimeout(() => {
                        const table = document.getElementById('sparklineTable');
                        if (table) table.focus();

                        const announcement = document.getElementById('sortAnnouncement');
                        if (announcement) {
                            const isExpanded = document.querySelectorAll('#sparklineTableBody .hidden-row').length === 0;
                            announcement.textContent = isExpanded
                                ? 'Tabela expandida. Agora todos os 27 estados estão visíveis. Pressione Enter ou Espaço para começar a navegar pelas células.'
                                : 'Tabela recolhida. Apenas os 5 primeiros estados estão visíveis.';
                        }
                    }, 200);
                });
            }

            const btnStatus = document.getElementById('showMoreStatusButton');
            if (btnStatus) {
                btnStatus.addEventListener('click', () => {
                    toggleShowAllStatus();
                    setTimeout(() => {
                        const table = document.getElementById('statusTableByState');
                        if (table) table.focus();
                    }, 200);
                });
            }

            const btnEntrada = document.getElementById('showMoreEntradaButton');
            if (btnEntrada) {
                btnEntrada.addEventListener('click', () => {
                    toggleShowAllEntrada();
                    setTimeout(() => {
                        const table = document.getElementById('entradaTableByState');
                        if (table) table.focus();
                    }, 200);
                });
            }

            function animateBarCharts() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const fills = entry.target.querySelectorAll('.bar-chart-fill');
                            fills.forEach((fill, index) => {
                                setTimeout(() => {
                                    const percentage = fill.getAttribute('data-percentage');
                                    const count = fill.getAttribute('data-count');
                                    fill.style.width = percentage + '%';

                                    const textElement = fill.querySelector('.bar-chart-fill-text');
                                    if (textElement && count) {
                                        textElement.textContent = percentage + '% (' + count + ')';
                                    }
                                    setTimeout(() => {
                                        fill.classList.add('animated');
                                    }, 100);
                                }, index * 100);
                            });
                            observer.unobserve(entry.target);
                        }
                    });
                }, {
                    threshold: 0.1
                });

                document.querySelectorAll('.bar-chart-list').forEach(chart => {
                    observer.observe(chart);
                });
            }

            if (btnAcessibilidade) {
                btnAcessibilidade.addEventListener('click', () => {
                    if (typeof toggleShowAll === 'function') {
                        toggleShowAll();
                        setTimeout(() => document.getElementById('sparklineTable')?.focus(), 200);
                    }
                });
            }

            if (btnStatus) {
                btnStatus.addEventListener('click', () => {
                    if (typeof toggleShowAllStatus === 'function') {
                        toggleShowAllStatus();
                        setTimeout(() => document.getElementById('statusTableByState')?.focus(), 200);
                    }
                });
            }

            if (btnEntrada) {
                btnEntrada.addEventListener('click', () => {
                    if (typeof toggleShowAllEntrada === 'function') {
                        toggleShowAllEntrada();
                        setTimeout(() => document.getElementById('entradaTableByState')?.focus(), 200);
                    }
                });
            }

            animateBarCharts();
            renderStatusGrid();
            renderDigitalGrid();
        });
    </script>
</body>

</html>